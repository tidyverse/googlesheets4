<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Specifying the range and column types, getting detailed cell data">
<title>Read Sheets • googlesheets4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read Sheets">
<meta property="og:description" content="Specifying the range and column types, getting detailed cell data">
<meta property="og:image" content="https://googlesheets4.tidyverse.org/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="googlesheets4.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">googlesheets4</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/googlesheets4.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/read-sheets.html">Read Sheets</a>
    <a class="dropdown-item" href="../articles/write-sheets.html">Write Sheets</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Special topics</h6>
    <a class="dropdown-item" href="../articles/auth.html">googlesheets4 auth</a>
    <a class="dropdown-item" href="../articles/dates-and-times.html">Dates and times</a>
    <a class="dropdown-item" href="../articles/find-identify-sheets.html">Find and identify Sheets</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Connections to other packages</h6>
    <a class="dropdown-item" href="../articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>
    <a class="dropdown-item" href="../articles/fun-with-googledrive-and-readxl.html">Fun with googledrive and readxl</a>
    <a class="dropdown-item" href="../articles/googlesheets4-reprex.html">How to create a googlesheets4 reprex</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/07/googlesheets4-1-0-0/">googlesheets4 1.0.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/">googlesheets4 0.2.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidyverse/googlesheets4/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Read Sheets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/googlesheets4/blob/HEAD/vignettes/articles/read-sheets.Rmd" class="external-link"><code>vignettes/articles/read-sheets.Rmd</code></a></small>
      <div class="d-none name"><code>read-sheets.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://googlesheets4.tidyverse.org">googlesheets4</a></span><span class="op">)</span></span></code></pre></div>
<p>Basic Sheet reading is shown in the <a href="https://googlesheets4.tidyverse.org/articles/googlesheets4.html">Get
started</a> article. Here we show how to target a specific (work)sheet
or cell range, how to deal with column types, and how to get detailed
cell data.</p>
<div class="section level2">
<h2 id="auth">Auth<a class="anchor" aria-label="anchor" href="#auth"></a>
</h2>
<p>As a regular, interactive user, you can just let googlesheets4 prompt
you for anything it needs re: auth.</p>
<p>Since this article is compiled noninteractively on a server, we have
arranged for googlesheets4 to use a service account token (not
shown).</p>
</div>
<div class="section level2">
<h2 id="read_sheet-and-range_read-are-synonyms">
<code>read_sheet()</code> and <code>range_read()</code> are
synonyms<a class="anchor" aria-label="anchor" href="#read_sheet-and-range_read-are-synonyms"></a>
</h2>
<p>The main “read” function of the googlesheets4 package goes by two
names, because we want it to make sense in two contexts:</p>
<ul>
<li><p><code><a href="../reference/range_read.html">read_sheet()</a></code> evokes other table-reading functions,
like <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code> and
<code><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel()</a></code>. The <code>sheet</code> in this case
refers to a Google (spread)Sheet.</p></li>
<li><p><code><a href="../reference/range_read.html">range_read()</a></code> is technically the right name according
to the naming convention used throughout the googlesheets4 package,
because we can read from an arbitrary cell range.</p></li>
</ul>
<p><code><a href="../reference/range_read.html">read_sheet()</a></code> and <code><a href="../reference/range_read.html">range_read()</a></code> are synonyms
and you can use either one. Throughout this article, we’re going to use
<code><a href="../reference/range_read.html">range_read()</a></code>.</p>
<p>Note: The first release of googlesheets used a <code>sheets_</code>
prefix everywhere, so we had <code>sheets_read()</code>. It still works,
but it’s deprecated and will go away rather swiftly.</p>
</div>
<div class="section level2">
<h2 id="specify-the-range-and-column-types">Specify the range and column types<a class="anchor" aria-label="anchor" href="#specify-the-range-and-column-types"></a>
</h2>
<p>Here we read from the “mini-gap” and “deaths” example Sheets to show
some of the different ways to specify (work)sheet and cell ranges.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"mini-gap"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">mini-gap</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range '<span style="color: #BBBB00;">'Americas'</span>'.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   country   continent  year lifeExp      pop gdpPercap</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Argentina Americas   <span style="text-decoration: underline;">1</span>952    62.5 17<span style="text-decoration: underline;">876</span>956     <span style="text-decoration: underline;">5</span>911.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Bolivia   Americas   <span style="text-decoration: underline;">1</span>952    40.4  2<span style="text-decoration: underline;">883</span>315     <span style="text-decoration: underline;">2</span>677.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Brazil    Americas   <span style="text-decoration: underline;">1</span>952    50.9 56<span style="text-decoration: underline;">602</span>560     <span style="text-decoration: underline;">2</span>109.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Canada    Americas   <span style="text-decoration: underline;">1</span>952    68.8 14<span style="text-decoration: underline;">785</span>584    <span style="text-decoration: underline;">11</span>367.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Chile     Americas   <span style="text-decoration: underline;">1</span>952    54.7  6<span style="text-decoration: underline;">377</span>619     <span style="text-decoration: underline;">3</span>940.</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"mini-gap"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="st">"Oceania"</span>, n_max <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">mini-gap</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range '<span style="color: #BBBB00;">'Oceania'</span>'.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;   country     continent  year lifeExp     pop gdpPercap</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Australia   Oceania    <span style="text-decoration: underline;">1</span>952    69.1 8<span style="text-decoration: underline;">691</span>212    <span style="text-decoration: underline;">10</span>040.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> New Zealand Oceania    <span style="text-decoration: underline;">1</span>952    69.4 1<span style="text-decoration: underline;">994</span>794    <span style="text-decoration: underline;">10</span>557.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Australia   Oceania    <span style="text-decoration: underline;">1</span>957    70.3 9<span style="text-decoration: underline;">712</span>569    <span style="text-decoration: underline;">10</span>950.</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"deaths"</span><span class="op">)</span>, skip <span class="op">=</span> <span class="fl">4</span>, n_max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">deaths</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range <span style="color: #BBBB00;">5:10000000</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt;    Name               Profession   Age `Has kids` `Date of birth`    </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> David Bowie        musician      69 TRUE       1947-01-08 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Carrie Fisher      actor         60 TRUE       1956-10-21 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Chuck Berry        musician      90 TRUE       1926-10-18 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Bill Paxton        actor         61 TRUE       1955-05-17 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Prince             musician      57 TRUE       1958-06-07 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Alan Rickman       actor         69 FALSE      1946-02-21 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Florence Henderson actor         82 TRUE       1934-02-14 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Harper Lee         author        89 FALSE      1926-04-28 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Zsa Zsa Gábor      actor         99 TRUE       1917-02-06 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> George Michael     musician      53 FALSE      1963-06-25 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: `Date of death` &lt;dttm&gt;</span></span></span></code></pre></div>
<p>The example below shows the use of <code>range</code> to specify both
the (work)sheet and an A1-style cell range.</p>
<p>It also demonstrates how <code>col_types</code> gives control of
column types, similar to how <code>col_types</code> works in readr and
readxl. Note that currently there is only support for the “shortcode”
style of column specification and we plan to align better with readr’s
capabilities in a future release.</p>
<ul>
<li>For the full list of column types and how to specify them, see the
<a href="https://googlesheets4.tidyverse.org/reference/range_read.html#column-specification">Column
specification</a> section of the help for
<code><a href="../reference/range_read.html">range_read()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/range_read.html">range_read</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"deaths"</span><span class="op">)</span>, range <span class="op">=</span> <span class="st">"other!A5:F15"</span>, col_types <span class="op">=</span> <span class="st">"?ci??D"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">deaths</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range '<span style="color: #BBBB00;">'other'!A5:F15</span>'.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt;    Name    Profession   Age `Has kids` `Date of birth`     `Date of death`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Vera R… scientist     88 TRUE       1928-07-23 <span style="color: #949494;">00:00:00</span> 2016-12-25     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Mohame… athlete       74 TRUE       1942-01-17 <span style="color: #949494;">00:00:00</span> 2016-06-03     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Morley… journalist    84 TRUE       1931-11-08 <span style="color: #949494;">00:00:00</span> 2016-05-19     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Fidel … politician    90 TRUE       1926-08-13 <span style="color: #949494;">00:00:00</span> 2016-11-25     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Antoni… lawyer        79 TRUE       1936-03-11 <span style="color: #949494;">00:00:00</span> 2016-02-13     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Jo Cox  politician    41 TRUE       1974-06-22 <span style="color: #949494;">00:00:00</span> 2016-06-16     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Janet … lawyer        78 FALSE      1938-07-21 <span style="color: #949494;">00:00:00</span> 2016-11-07     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Gwen I… journalist    61 FALSE      1955-09-29 <span style="color: #949494;">00:00:00</span> 2016-11-14     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> John G… astronaut     95 TRUE       1921-07-28 <span style="color: #949494;">00:00:00</span> 2016-12-08     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Pat Su… coach         64 TRUE       1952-06-14 <span style="color: #949494;">00:00:00</span> 2016-06-28</span></span></code></pre></div>
<p>If you looked at the “deaths” spreadsheet in the browser (it’s <a href="https://docs.google.com/spreadsheets/d/1VTJjWoP1nshbyxmL9JqXgdVsimaYty21LGxxs018H2Y" class="external-link">here</a>),
you know that it has some of the typical features of real world
spreadsheets: the main data rectangle has prose intended for
human-consumption before and after it. That’s why we have to specify the
range when we read from it.</p>
<p>We’ve designated the data rectangles as <a href="https://support.google.com/docs/answer/63175?co=GENIE.Platform%3DDesktop&amp;hl=en" class="external-link">named
ranges</a>, which provides a very slick way to read them – definitely
less brittle and mysterious than approaches like
<code>range = "other!A5:F15"</code> or
<code>skip = 4, n_max = 10</code>. A named range can be passed via the
<code>range =</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"deaths"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/range_read.html">range_read</a></span><span class="op">(</span>range <span class="op">=</span> <span class="st">"arts_data"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">deaths</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range <span style="color: #BBBB00;">arts_data</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt;    Name               Profession   Age `Has kids` `Date of birth`    </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> David Bowie        musician      69 TRUE       1947-01-08 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Carrie Fisher      actor         60 TRUE       1956-10-21 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Chuck Berry        musician      90 TRUE       1926-10-18 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Bill Paxton        actor         61 TRUE       1955-05-17 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Prince             musician      57 TRUE       1958-06-07 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Alan Rickman       actor         69 FALSE      1946-02-21 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Florence Henderson actor         82 TRUE       1934-02-14 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Harper Lee         author        89 FALSE      1926-04-28 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Zsa Zsa Gábor      actor         99 TRUE       1917-02-06 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> George Michael     musician      53 FALSE      1963-06-25 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: `Date of death` &lt;dttm&gt;</span></span></span></code></pre></div>
<p>The named ranges, if any exist, are part of the information returned
by <code><a href="../reference/gs4_get.html">gs4_get()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="detailed-cell-data">Detailed cell data<a class="anchor" aria-label="anchor" href="#detailed-cell-data"></a>
</h2>
<p><code><a href="../reference/range_read_cells.html">range_read_cells()</a></code> returns a data frame with one row per
cell and it gives access to raw cell data sent by the Sheets API.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/range_read_cells.html">range_read_cells</a></span><span class="op">(</span><span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"deaths"</span><span class="op">)</span>, range <span class="op">=</span> <span class="st">"E5:E7"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">deaths</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range <span style="color: #BBBB00;">E5:E7</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;     row   col loc   cell      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     5     5 E5    <span style="color: #949494;">&lt;CELL_TEX&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     6     5 E6    <span style="color: #949494;">&lt;CELL_DAT&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     7     5 E7    <span style="color: #949494;">&lt;CELL_DAT&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">cell</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $effectiveValue</span></span>
<span><span class="co">#&gt; $effectiveValue$numberValue</span></span>
<span><span class="co">#&gt; [1] 20749</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $formattedValue</span></span>
<span><span class="co">#&gt; [1] "10/21/1956"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $effectiveFormat</span></span>
<span><span class="co">#&gt; $effectiveFormat$numberFormat</span></span>
<span><span class="co">#&gt; $effectiveFormat$numberFormat$type</span></span>
<span><span class="co">#&gt; [1] "DATE"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $effectiveFormat$numberFormat$pattern</span></span>
<span><span class="co">#&gt; [1] "M/D/YYYY"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "CELL_DATE"   "SHEETS_CELL"</span></span></code></pre></div>
<p>Specify <code>cell_data = "full", discard_empty = FALSE</code> to get
even more data if you, for example, need access to cell formulas or
formatting.</p>
<p><code><a href="../reference/spread_sheet.html">spread_sheet()</a></code> converts data in the “one row per cell”
form into the data frame you get from <code><a href="../reference/range_read.html">range_read()</a></code>, which
involves reshaping and column typing.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/spread_sheet.html">spread_sheet</a></span><span class="op">(</span>col_types <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 1</span></span></span>
<span><span class="co">#&gt;   `Date of birth`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1947-01-08     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1956-10-21</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## is same as ...</span></span>
<span><span class="fu"><a href="../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"deaths"</span><span class="op">)</span>, range <span class="op">=</span> <span class="st">"E5:E7"</span>, col_types <span class="op">=</span><span class="st">"D"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">deaths</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range <span style="color: #BBBB00;">E5:E7</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 1</span></span></span>
<span><span class="co">#&gt;   `Date of birth`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1947-01-08     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1956-10-21</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="when-speed-matters">When speed matters<a class="anchor" aria-label="anchor" href="#when-speed-matters"></a>
</h2>
<p>If your Sheet is so large that the speed of <code><a href="../reference/range_read.html">range_read()</a></code>
is causing problems, consider <code><a href="../reference/range_speedread.html">range_speedread()</a></code>. It uses a
special URL that allows a Sheet to be read as comma-separated values
(CSV). Access via this URL doesn’t use the Sheets API (although
<code><a href="../reference/range_speedread.html">range_speedread()</a></code> still makes an API call to retrieve Sheet
metadata). As an example, on a Sheet with around 57,000 rows and 25
columns (over 1.4 million cells), <code><a href="../reference/range_speedread.html">range_speedread()</a></code> takes
~5 seconds, whereas <code><a href="../reference/range_read.html">range_read()</a></code> takes closer to 3 minutes.
Why wouldn’t we always take the faster option?!? Because the speed
difference is imperceptible for many Sheets and there are some downsides
(described later).</p>
<p><code><a href="../reference/range_speedread.html">range_speedread()</a></code> has much the same interface as
<code><a href="../reference/range_read.html">range_read()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"gapminder"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/range_speedread.html">range_speedread</a></span><span class="op">(</span>sheet <span class="op">=</span> <span class="st">"Oceania"</span>, n_max <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">gapminder</span>, sheet <span style="color: #00BB00;">Oceania</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Export URL:</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB; font-style: italic;">&lt;https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/export?format=csv&amp;gid=1796776040&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">3</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (2): country, continent</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (4): year, lifeExp, pop, gdpPercap</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;   country   continent  year lifeExp      pop gdpPercap</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Australia Oceania    <span style="text-decoration: underline;">1</span>952    69.1  8<span style="text-decoration: underline;">691</span>212    <span style="text-decoration: underline;">10</span>040.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Australia Oceania    <span style="text-decoration: underline;">1</span>957    70.3  9<span style="text-decoration: underline;">712</span>569    <span style="text-decoration: underline;">10</span>950.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Australia Oceania    <span style="text-decoration: underline;">1</span>962    70.9 10<span style="text-decoration: underline;">794</span>968    <span style="text-decoration: underline;">12</span>217.</span></span></code></pre></div>
<p>The output above reveals that, under the hood,
<code><a href="../reference/range_speedread.html">range_speedread()</a></code> calls an external function for CSV
parsing (namely, <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code>). An important
consequence is that all arguments around column type specification are
passed along to the CSV-parsing function. Here is a demo using
readr-style column specification:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"deaths"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/range_speedread.html">range_speedread</a></span><span class="op">(</span></span>
<span>    range <span class="op">=</span> <span class="st">"other!A5:F15"</span>,</span>
<span>    col_types <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols</a></span><span class="op">(</span></span>
<span>      Age <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html" class="external-link">col_integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      `Date of birth` <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_datetime.html" class="external-link">col_date</a></span><span class="op">(</span><span class="st">"%m/%d/%Y"</span><span class="op">)</span>,</span>
<span>      `Date of death` <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_datetime.html" class="external-link">col_date</a></span><span class="op">(</span><span class="st">"%m/%d/%Y"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">deaths</span>, sheet <span style="color: #00BB00;">other</span>, range <span style="color: #BBBB00;">A5:F15</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Export URL:</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB; font-style: italic;">&lt;https://docs.google.com/spreadsheets/d/1VTJjWoP1nshbyxmL9JqXgdVsimaYty21LGxxs018H2Y/export?format=csv&amp;range=A5%3AF15&amp;gid=278837031&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt;    Name        Profession   Age `Has kids` `Date of birth` `Date of death`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Vera Rubin  scientist     88 TRUE       1928-07-23      2016-12-25     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Mohamed Ali athlete       74 TRUE       1942-01-17      2016-06-03     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Morley Saf… journalist    84 TRUE       1931-11-08      2016-05-19     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Fidel Cast… politician    90 TRUE       1926-08-13      2016-11-25     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Antonin Sc… lawyer        79 TRUE       1936-03-11      2016-02-13     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Jo Cox      politician    41 TRUE       1974-06-22      2016-06-16     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Janet Reno  lawyer        78 FALSE      1938-07-21      2016-11-07     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Gwen Ifill  journalist    61 FALSE      1955-09-29      2016-11-14     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> John Glenn  astronaut     95 TRUE       1921-07-28      2016-12-08     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Pat Summit  coach         64 TRUE       1952-06-14      2016-06-28</span></span></code></pre></div>
<p>Compare that to how we would read the same data with
<code><a href="../reference/range_read.html">range_read()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"deaths"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/range_read.html">range_read</a></span><span class="op">(</span>range <span class="op">=</span> <span class="st">"other_data"</span>, col_types <span class="op">=</span> <span class="st">"??i?DD"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">deaths</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range <span style="color: #BBBB00;">other_data</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt;    Name        Profession   Age `Has kids` `Date of birth` `Date of death`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Vera Rubin  scientist     88 TRUE       1928-07-23      2016-12-25     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Mohamed Ali athlete       74 TRUE       1942-01-17      2016-06-03     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Morley Saf… journalist    84 TRUE       1931-11-08      2016-05-19     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Fidel Cast… politician    90 TRUE       1926-08-13      2016-11-25     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Antonin Sc… lawyer        79 TRUE       1936-03-11      2016-02-13     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Jo Cox      politician    41 TRUE       1974-06-22      2016-06-16     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Janet Reno  lawyer        78 FALSE      1938-07-21      2016-11-07     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Gwen Ifill  journalist    61 FALSE      1955-09-29      2016-11-14     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> John Glenn  astronaut     95 TRUE       1921-07-28      2016-12-08     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Pat Summit  coach         64 TRUE       1952-06-14      2016-06-28</span></span></code></pre></div>
<p>This example highlights two important differences:</p>
<ul>
<li>
<code>range = "other!A5:F15"</code> versus
<code>range = "other_data"</code>: <code><a href="../reference/range_speedread.html">range_speedread()</a></code> can’t
access a named range, whereas <code><a href="../reference/range_read.html">range_read()</a></code> can.</li>
<li>
<code>readr::col_date("%m/%d/%Y")</code> vs <code>D</code>:
<code><a href="../reference/range_speedread.html">range_speedread()</a></code> must parse a character representation of
all cell data, including datetimes, whereas <code><a href="../reference/range_read.html">range_read()</a></code>
has access to the actual cell data and its type.</li>
</ul>
<p>What’s the speed difference for something like the Africa sheet in
the “gapminder” example Sheet? (around 625 rows x 6 columns, or 3700
cells)</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"gapminder"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/range_speedread.html">range_speedread</a></span><span class="op">(</span>sheet <span class="op">=</span> <span class="st">"Africa"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">gapminder</span>, sheet <span style="color: #00BB00;">Africa</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Export URL:</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB; font-style: italic;">&lt;https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/export?format=csv&amp;gid=780868077&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">624</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (2): country, continent</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (4): year, lifeExp, pop, gdpPercap</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.089   0.012   0.409</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"gapminder"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/range_read.html">range_read</a></span><span class="op">(</span>sheet <span class="op">=</span> <span class="st">"Africa"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">gapminder</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range '<span style="color: #BBBB00;">'Africa'</span>'.</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.295   0.019   0.565</span></span></code></pre></div>
<p>The modest difference above shows that the speed difference is
unlikely to be a gamechanger in many settings.</p>
<p>Summary of how to think about <code><a href="../reference/range_speedread.html">range_speedread()</a></code> vs
<code><a href="../reference/range_read.html">range_read()</a></code>:</p>
<ul>
<li>Both use auth (literally, send a token), unless there was a prior to
call to <code><a href="../reference/gs4_deauth.html">gs4_deauth()</a></code>.</li>
<li>
<code><a href="../reference/range_speedread.html">range_speedread()</a></code> is faster, but it’s not noticeable
for typical Sheets.</li>
<li>
<code><a href="../reference/range_speedread.html">range_speedread()</a></code> uses readr-style column type
specification, which is actually more flexible than what
<code><a href="../reference/range_read.html">range_read()</a></code> currently does. In future googlesheets4
releases, we will adopt readr-style column type specification.</li>
<li>
<code><a href="../reference/range_speedread.html">range_speedread()</a></code> requires more detailed column type
specification, because it cannot access unformatted cell data and the
actual cell type, as <code><a href="../reference/range_read.html">range_read()</a></code> can.</li>
<li>
<code><a href="../reference/range_speedread.html">range_speedread()</a></code> can’t access full cell data, e.g.,
formatting.</li>
<li>
<code><a href="../reference/range_speedread.html">range_speedread()</a></code> can’t work with named ranges.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

  </div></footer>
</body>
</html>
