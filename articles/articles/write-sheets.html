<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Write Sheets • googlesheets4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../tidyverse-2.css" rel="stylesheet">
<!--optional theme--><link href="../../.css" rel="stylesheet">
<meta property="og:title" content="Write Sheets">
<meta property="og:description" content="Targeting different parts of a Sheet, writing formulas, addressing cell format">
<meta property="og:image" content="https://googlesheets4.tidyverse.org/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../../index.html">googlesheets4</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../articles/googlesheets4.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/read-sheets.html">Read Sheets</a>
    </li>
    <li>
      <a href="../../articles/articles/write-sheets.html">Write Sheets</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Special topics</li>
    <li>
      <a href="../../articles/articles/auth.html">googlesheets4 auth</a>
    </li>
    <li>
      <a href="../../articles/articles/dates-and-times.html">Dates and times</a>
    </li>
    <li>
      <a href="../../articles/articles/find-identify-sheets.html">Find and identify Sheets</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Connections to other packages</li>
    <li>
      <a href="../../articles/articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>
    </li>
    <li>
      <a href="../../articles/articles/fun-with-googledrive-and-readxl.html">Fun with googledrive and readxl</a>
    </li>
    <li>
      <a href="../../articles/articles/googlesheets4-reprex.html">How to create a googlesheets4 reprex</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Blog posts</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/">googlesheets4 0.2.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/googlesheets4/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="write-sheets_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Write Sheets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/googlesheets4/blob/master/vignettes/articles/write-sheets.Rmd"><code>vignettes/articles/write-sheets.Rmd</code></a></small>
      <div class="hidden name"><code>write-sheets.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://googlesheets4.tidyverse.org">googlesheets4</a></span><span class="op">)</span></code></pre></div>
<p>Basic Sheet writing is shown in the <a href="https://googlesheets4.tidyverse.org/articles/googlesheets4.html">Get started</a> article. Here we explore the different uses for the writing functions:</p>
<ul>
<li>
<code><a href="../../reference/gs4_create.html">gs4_create()</a></code> emphasizes the creation of a new (spread)Sheet.
<ul>
<li>But it can create (work)sheets and write data.</li>
</ul>
</li>
<li>
<code><a href="../../reference/sheet_write.html">sheet_write()</a></code> emphasizes writing a data frame into a (work)sheet.
<ul>
<li>But it can create a new (spread)Sheet or a new (work)sheet.</li>
</ul>
</li>
<li>
<code><a href="../../reference/sheet_append.html">sheet_append()</a></code> is about adding rows to an existing data table.</li>
<li>
<code><a href="../../reference/gs4_create.html">gs4_create()</a></code>, <code><a href="../../reference/sheet_write.html">sheet_write()</a></code>, and <code><a href="../../reference/sheet_append.html">sheet_append()</a></code> implement holistic operations for representing a single R data frame as a table in a (work)sheet within a Google Sheet.
<ul>
<li>
<code><a href="../../reference/gs4_create.html">gs4_create()</a></code> and <code><a href="../../reference/sheet_write.html">sheet_write()</a></code> both impose this mentality via specific formatting, such as special treatment of the column header row.</li>
<li>All 3 functions aim to shrink-wrap the data.</li>
</ul>
</li>
<li>
<code><a href="../../reference/range_write.html">range_write()</a></code> is the one function that helps you write arbitrary data into an arbitrary range, although it is still oriented around a data frame.</li>
<li>
<code><a href="../../reference/range_flood.html">range_flood()</a></code> writes common content into all of the cells in a range.
<ul>
<li>An important special case is <em>clearing</em> a range of cells of their existing values and, optionally, formatting.</li>
</ul>
</li>
<li>
<code><a href="../../reference/range_delete.html">range_delete()</a></code> deletes a range of cells and shifts other cells into the deleted area.</li>
</ul>
<div id="auth" class="section level2">
<h2 class="hasAnchor">
<a href="#auth" class="anchor"></a>Auth</h2>
<p>As a regular, interactive user, you can just let googlesheets4 prompt you for anything it needs re: auth.</p>
<p>Since this article is compiled noninteractively on a server, we have arranged for googlesheets4 to use a service account token (not shown).</p>
</div>
<div id="gs4_create" class="section level2">
<h2 class="hasAnchor">
<a href="#gs4_create" class="anchor"></a><code>gs4_create()</code>
</h2>
<p>Create a brand new Sheet with <code><a href="../../reference/gs4_create.html">gs4_create()</a></code>. You can specify the new Sheet’s <code>name</code> (or accept a randomly generated name).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ss1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span><span class="st">"sheets-create-demo-1"</span><span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'sheets-create-demo-1'</span>
<span class="va">ss1</span>
<span class="co">#&gt; Spreadsheet name: sheets-create-demo-1</span>
<span class="co">#&gt;               ID: 12Kh4GdjgOxGG-AiQ5pef6fEpluh2NQYXXHXm3CZb-oU</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;       Sheet1: 1000 x 26</span></code></pre></div>
<p>Every Sheet <em>must</em> have at least one (work)sheet, so Google Sheets automatically creates an empty “Sheet1”.</p>
<p>You can control the names and content of the initial (work)sheets with the <code>sheets</code> argument.</p>
<div id="send-sheet-names" class="section level3">
<h3 class="hasAnchor">
<a href="#send-sheet-names" class="anchor"></a>Send sheet names</h3>
<p>Use a character vector to specify the names of one or more empty sheets.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ss2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span>
  <span class="st">"sheets-create-demo-2"</span>,
  sheets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'sheets-create-demo-2'</span>
<span class="va">ss2</span>
<span class="co">#&gt; Spreadsheet name: sheets-create-demo-2</span>
<span class="co">#&gt;               ID: 1fCIyuimJYiIiBSZxB8TP570DmNHZhK4T_99eyIxdoQk</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;        alpha: 1000 x 26</span>
<span class="co">#&gt;         beta: 1000 x 26</span></code></pre></div>
<p>These sheets have no values and get their dimensions from Sheets default behaviour.</p>
</div>
<div id="send-a-data-frame" class="section level3">
<h3 class="hasAnchor">
<a href="#send-a-data-frame" class="anchor"></a>Send a data frame</h3>
<p>If you provide a data frame, it is used to populate the cells of a sheet and to set sheet dimensions (number of rows and columns). The header row also gets special treatment. The sheet inherits the name of the data frame, where possible.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>

<span class="va">ss3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span>
  <span class="st">"sheets-create-demo-3"</span>,
  sheets <span class="op">=</span> <span class="va">my_data</span>
<span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'sheets-create-demo-3'</span>
<span class="va">ss3</span>
<span class="co">#&gt; Spreadsheet name: sheets-create-demo-3</span>
<span class="co">#&gt;               ID: 1p1S-ozH4U9mLhyeA24oyXCJuNdnhbr0qj7_ge8HgIGw</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;      my_data: 4 x 2</span></code></pre></div>
</div>
<div id="send-multiple-data-frames" class="section level3">
<h3 class="hasAnchor">
<a href="#send-multiple-data-frames" class="anchor"></a>Send multiple data frames</h3>
<p>If you provide a list of data frames, each is used to populate the cells of one sheet and to set sheet dimensions (number of rows and columns). The header row also gets special treatment. The sheets inherit the names from the list, if it has names.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data_frames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>iris <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>, chickwts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">chickwts</span><span class="op">)</span><span class="op">)</span>

<span class="va">ss4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span>
  <span class="st">"sheets-create-demo-4"</span>,
  sheets <span class="op">=</span> <span class="va">my_data_frames</span>
<span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'sheets-create-demo-4'</span>
<span class="va">ss4</span>
<span class="co">#&gt; Spreadsheet name: sheets-create-demo-4</span>
<span class="co">#&gt;               ID: 1tS4rB1oCb5EqrtqwGVjBVAz5oNfJT1nzahd7cm8leLc</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;         iris: 7 x 5</span>
<span class="co">#&gt;     chickwts: 7 x 2</span></code></pre></div>
</div>
<div id="write-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#write-metadata" class="anchor"></a>Write metadata</h3>
<p>Most users won’t need to do this, but <code><a href="../../reference/gs4_create.html">gs4_create()</a></code> can set additional Sheet-level metadata, such as locale or time zone. To really make use of this feature, you need to read up on the <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/create"><code>spreadsheets.create</code> endpoint</a>.</p>
<p>Notice how the default empty Sheet here is named “Feuille 1”, since we request a French locale.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ss5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span>
  <span class="st">"sheets-create-demo-5"</span>,
  locale <span class="op">=</span> <span class="st">"fr_FR"</span>,
  timeZone <span class="op">=</span> <span class="st">"Europe/Paris"</span>
<span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'sheets-create-demo-5'</span>
<span class="va">ss5</span>
<span class="co">#&gt; Spreadsheet name: sheets-create-demo-5</span>
<span class="co">#&gt;               ID: 1Mtpd1J1o167-L7wO4ydq2V60v_2t-ejidfFx3NE1A-4</span>
<span class="co">#&gt;           Locale: fr_FR</span>
<span class="co">#&gt;        Time zone: Europe/Paris</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;    Feuille 1: 1000 x 26</span></code></pre></div>
<p>I would only do this if you have specific evidence that the default behaviour with respect to locale and time zone is problematic for your use case.</p>
</div>
<div id="clean-up" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up" class="anchor"></a>Clean up</h3>
<p>Trash all the Sheets created above. This actually requires googledrive, since it is not possible to trash or delete Sheets through the Sheets API. In our hidden auth process, described earlier, we put a shared token into force for both Sheets and Drive. You can read how to do that in your own work in the article <a href="https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/gs4_find.html">gs4_find</a></span><span class="op">(</span><span class="st">"sheets-create-demo"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Files trashed:</span>
<span class="co">#&gt; • sheets-create-demo-5 &lt;id: 1Mtpd1J1o167-L7wO4ydq2V60v_2t-ejidfFx3NE1A-4&gt;</span>
<span class="co">#&gt; • sheets-create-demo-4 &lt;id: 1tS4rB1oCb5EqrtqwGVjBVAz5oNfJT1nzahd7cm8leLc&gt;</span>
<span class="co">#&gt; • sheets-create-demo-3 &lt;id: 1p1S-ozH4U9mLhyeA24oyXCJuNdnhbr0qj7_ge8HgIGw&gt;</span>
<span class="co">#&gt; • sheets-create-demo-2 &lt;id: 1fCIyuimJYiIiBSZxB8TP570DmNHZhK4T_99eyIxdoQk&gt;</span>
<span class="co">#&gt; • sheets-create-demo-1 &lt;id: 12Kh4GdjgOxGG-AiQ5pef6fEpluh2NQYXXHXm3CZb-oU&gt;</span></code></pre></div>
</div>
</div>
<div id="write_sheet-a-k-a--sheet_write" class="section level2">
<h2 class="hasAnchor">
<a href="#write_sheet-a-k-a--sheet_write" class="anchor"></a><code>write_sheet()</code>, a.k.a. <code>sheet_write()</code>
</h2>
<p><code><a href="../../reference/sheet_write.html">write_sheet()</a></code> is aliased to <code><a href="../../reference/sheet_write.html">sheet_write()</a></code> and is meant to evoke <code><a href="https://readr.tidyverse.org/reference/write_delim.html">readr::write_csv()</a></code> or <code>writexl::write_xlsx()</code>. Whereas <code><a href="../../reference/gs4_create.html">gs4_create()</a></code> emphasizes the <em>target Sheet</em>, <code><a href="../../reference/sheet_write.html">sheet_write()</a></code> emphasizes the <em>data you want to write</em>.</p>
<p>The only required argument for <code><a href="../../reference/sheet_write.html">sheet_write()</a></code> is the data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>

<span class="va">random_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sheet_write.html">sheet_write</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'droll-reindeer'</span>
<span class="va">random_ss</span>
<span class="co">#&gt; Spreadsheet name: droll-reindeer</span>
<span class="co">#&gt;               ID: 1B2A-uYIvZEV8qPXUpfdFoJqk3Rbv5MJJwKDMbo6qHQo</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;           df: 4 x 2</span></code></pre></div>
<p>This creates a new (work)sheet inside a new (spread)Sheet and returns its ID. You’ll notice the new Sheet has a randomly generated name. If that is a problem, use <code><a href="../../reference/gs4_create.html">gs4_create()</a></code> instead, which affords more control over various aspects of the new Sheet.</p>
<p>Let’s start over: we delete that Sheet and call <code><a href="../../reference/gs4_create.html">gs4_create()</a></code>, so we can specify the new Sheet’s name. Then we’ll modify it with <code><a href="../../reference/sheet_write.html">sheet_write()</a></code>. We send one sheet name, “chickwts”, to prevent the creation of “Sheet1”, but we send no data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span><span class="op">(</span><span class="va">random_ss</span><span class="op">)</span>
<span class="co">#&gt; File trashed:</span>
<span class="co">#&gt; • droll-reindeer &lt;id: 1B2A-uYIvZEV8qPXUpfdFoJqk3Rbv5MJJwKDMbo6qHQo&gt;</span>

<span class="va">ss1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span>
  <span class="st">"write-sheets-demo-1"</span>,
  sheets <span class="op">=</span> <span class="st">"chickwts"</span>
<span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'write-sheets-demo-1'</span>
<span class="va">ss1</span>
<span class="co">#&gt; Spreadsheet name: write-sheets-demo-1</span>
<span class="co">#&gt;               ID: 1V1EOOzI_8FG0iGGX7AIb4so4TWySt79JejojBoEF_Kc</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;     chickwts: 1000 x 26</span></code></pre></div>
<p><code><a href="../../reference/sheet_write.html">sheet_write()</a></code> allows us to write the actual <code>chickwts</code> data into the sheet by that name.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sheet_write.html">sheet_write</a></span><span class="op">(</span><span class="va">chickwts</span>, ss <span class="op">=</span> <span class="va">ss1</span>, sheet <span class="op">=</span> <span class="st">"chickwts"</span><span class="op">)</span>
<span class="co">#&gt; ✔ Writing to 'write-sheets-demo-1'</span>
<span class="co">#&gt; ✔ Writing to sheet 'chickwts'</span>
<span class="va">ss1</span>
<span class="co">#&gt; Spreadsheet name: write-sheets-demo-1</span>
<span class="co">#&gt;               ID: 1V1EOOzI_8FG0iGGX7AIb4so4TWySt79JejojBoEF_Kc</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;     chickwts: 72 x 2</span></code></pre></div>
<p><code><a href="../../reference/sheet_write.html">sheet_write()</a></code> can also write data into a new sheet, if <code>sheet</code> implicitly or explicitly targets a non-existent sheet.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># explicitly make a new sheet named "iris"</span>
<span class="fu"><a href="../../reference/sheet_write.html">sheet_write</a></span><span class="op">(</span><span class="va">iris</span>, ss <span class="op">=</span> <span class="va">ss1</span>, sheet <span class="op">=</span> <span class="st">"iris"</span><span class="op">)</span>
<span class="co">#&gt; ✔ Writing to 'write-sheets-demo-1'</span>
<span class="co">#&gt; ✔ Writing to sheet 'iris'</span>

<span class="co"># implicitly make a new sheet named "mtcars"</span>
<span class="fu"><a href="../../reference/sheet_write.html">sheet_write</a></span><span class="op">(</span><span class="va">mtcars</span>, ss <span class="op">=</span> <span class="va">ss1</span><span class="op">)</span>
<span class="co">#&gt; ✔ Writing to 'write-sheets-demo-1'</span>
<span class="co">#&gt; ✔ Writing to sheet 'mtcars'</span></code></pre></div>
<p>If no sheet name is given and it can’t be determined from <code>data</code>, a name of the form “SheetN” is automatically generated by Sheets.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sheet_write.html">sheet_write</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, ss <span class="op">=</span> <span class="va">ss1</span><span class="op">)</span>
<span class="co">#&gt; ✔ Writing to 'write-sheets-demo-1'</span>
<span class="co">#&gt; ✔ Writing to sheet 'Sheet1'</span>
<span class="va">ss1</span>
<span class="co">#&gt; Spreadsheet name: write-sheets-demo-1</span>
<span class="co">#&gt;               ID: 1V1EOOzI_8FG0iGGX7AIb4so4TWySt79JejojBoEF_Kc</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;     chickwts: 72 x 2</span>
<span class="co">#&gt;         iris: 151 x 5</span>
<span class="co">#&gt;       mtcars: 33 x 11</span>
<span class="co">#&gt;       Sheet1: 3 x 2</span></code></pre></div>
<div id="clean-up-1" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-1" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/gs4_find.html">gs4_find</a></span><span class="op">(</span><span class="st">"write-sheets-demo"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; File trashed:</span>
<span class="co">#&gt; • write-sheets-demo-1 &lt;id: 1V1EOOzI_8FG0iGGX7AIb4so4TWySt79JejojBoEF_Kc&gt;</span></code></pre></div>
</div>
</div>
<div id="sheet_append" class="section level2">
<h2 class="hasAnchor">
<a href="#sheet_append" class="anchor"></a><code>sheet_append()</code>
</h2>
<p><code><a href="../../reference/sheet_append.html">sheet_append()</a></code> can add one or more rows of data to an existing (work)sheet.</p>
<p>Let’s recreate the table of “other” deaths from an example Sheet, but without the annoying text above and below the data. First we bring that data into a local data frame and chop it into pieces.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_example.html">gs4_example</a></span><span class="op">(</span><span class="st">"deaths"</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span>range <span class="op">=</span> <span class="st">"other_data"</span>, col_types <span class="op">=</span> <span class="st">"????DD"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'deaths'</span>
<span class="co">#&gt; ✔ Range other_data</span>
<span class="co">#&gt; # A tibble: 10 x 6</span>
<span class="co">#&gt;    Name           Profession   Age `Has kids` `Date of birth` `Date of death`</span>
<span class="co">#&gt;    &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt; &lt;lgl&gt;      &lt;date&gt;          &lt;date&gt;         </span>
<span class="co">#&gt;  1 Vera Rubin     scientist     88 TRUE       1928-07-23      2016-12-25     </span>
<span class="co">#&gt;  2 Mohamed Ali    athlete       74 TRUE       1942-01-17      2016-06-03     </span>
<span class="co">#&gt;  3 Morley Safer   journalist    84 TRUE       1931-11-08      2016-05-19     </span>
<span class="co">#&gt;  4 Fidel Castro   politician    90 TRUE       1926-08-13      2016-11-25     </span>
<span class="co">#&gt;  5 Antonin Scalia lawyer        79 TRUE       1936-03-11      2016-02-13     </span>
<span class="co">#&gt;  6 Jo Cox         politician    41 TRUE       1974-06-22      2016-06-16     </span>
<span class="co">#&gt;  7 Janet Reno     lawyer        78 FALSE      1938-07-21      2016-11-07     </span>
<span class="co">#&gt;  8 Gwen Ifill     journalist    61 FALSE      1955-09-29      2016-11-14     </span>
<span class="co">#&gt;  9 John Glenn     astronaut     95 TRUE       1921-07-28      2016-12-08     </span>
<span class="co">#&gt; 10 Pat Summit     coach         64 TRUE       1952-06-14      2016-06-28</span>

<span class="va">deaths_zero</span>  <span class="op">&lt;-</span> <span class="va">deaths</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># "scaffolding" data frame with 0 rows</span>
<span class="va">deaths_one</span>   <span class="op">&lt;-</span> <span class="va">deaths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span> 
<span class="va">deaths_two</span>   <span class="op">&lt;-</span> <span class="va">deaths</span><span class="op">[</span><span class="fl">6</span>, <span class="op">]</span>
<span class="va">deaths_three</span> <span class="op">&lt;-</span> <span class="va">deaths</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></code></pre></div>
<p>We use <code><a href="../../reference/gs4_create.html">gs4_create()</a></code> to create a new (spread)Sheet and initialize a new (work)sheet with the “deaths” column headers, but no data. A second empty row is created (it must be, in order for us to freeze the top row), but it will soon be filled when we append.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span><span class="st">"sheets-append-demo"</span>, sheets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>deaths <span class="op">=</span> <span class="va">deaths_zero</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'sheets-append-demo'</span>
<span class="va">ss</span>
<span class="co">#&gt; Spreadsheet name: sheets-append-demo</span>
<span class="co">#&gt;               ID: 17POdlo-4LqE0Ztx6uSnMq4BR4iXCqAT8x6pP8J_n0mQ</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;       deaths: 2 x 6</span></code></pre></div>
<p>If you’re following along, I recommend you open this Sheet in a web browser with <code><a href="../../reference/gs4_browse.html">gs4_browse()</a></code> and revisit as we go along, to see how the initial empty row gets consumed and how additional rows are added to the targetted sheet automatically.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/gs4_browse.html">gs4_browse</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span></code></pre></div>
<p>Send the data, one or more rows at a time. Keep inspecting in the browser if you’re doing this yourself.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ss</span>
<span class="co">#&gt; Spreadsheet name: sheets-append-demo</span>
<span class="co">#&gt;               ID: 17POdlo-4LqE0Ztx6uSnMq4BR4iXCqAT8x6pP8J_n0mQ</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;       deaths: 2 x 6</span>

<span class="co"># send several rows</span>
<span class="va">ss</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../../reference/sheet_append.html">sheet_append</a></span><span class="op">(</span><span class="va">deaths_one</span><span class="op">)</span>
<span class="co">#&gt; ✔ Writing to 'sheets-append-demo'</span>
<span class="co">#&gt; ✔ Appending 5 rows to deaths</span>
<span class="va">ss</span>
<span class="co">#&gt; Spreadsheet name: sheets-append-demo</span>
<span class="co">#&gt;               ID: 17POdlo-4LqE0Ztx6uSnMq4BR4iXCqAT8x6pP8J_n0mQ</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;       deaths: 6 x 6</span>

<span class="co"># send a single row</span>
<span class="va">ss</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../../reference/sheet_append.html">sheet_append</a></span><span class="op">(</span><span class="va">deaths_two</span><span class="op">)</span>
<span class="co">#&gt; ✔ Writing to 'sheets-append-demo'</span>
<span class="co">#&gt; ✔ Appending 1 row to deaths</span>
<span class="va">ss</span>
<span class="co">#&gt; Spreadsheet name: sheets-append-demo</span>
<span class="co">#&gt;               ID: 17POdlo-4LqE0Ztx6uSnMq4BR4iXCqAT8x6pP8J_n0mQ</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;       deaths: 7 x 6</span>

<span class="co"># send remaining rows</span>
<span class="va">ss</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../../reference/sheet_append.html">sheet_append</a></span><span class="op">(</span><span class="va">deaths_three</span><span class="op">)</span>
<span class="co">#&gt; ✔ Writing to 'sheets-append-demo'</span>
<span class="co">#&gt; ✔ Appending 4 rows to deaths</span>
<span class="va">ss</span>
<span class="co">#&gt; Spreadsheet name: sheets-append-demo</span>
<span class="co">#&gt;               ID: 17POdlo-4LqE0Ztx6uSnMq4BR4iXCqAT8x6pP8J_n0mQ</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;       deaths: 11 x 6</span></code></pre></div>
<p>Now the big reveal: have we successfully rebuilt that data through incremental updates?</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deaths_replica</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="va">ss</span>, col_types <span class="op">=</span> <span class="st">"????DD"</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'sheets-append-demo'</span>
<span class="co">#&gt; ✔ Range deaths</span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">deaths</span>, <span class="va">deaths_replica</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Gosh I hope that’s still <code>TRUE</code> as it was the last time I checked this article!</p>
<div id="clean-up-2" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-2" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/gs4_find.html">gs4_find</a></span><span class="op">(</span><span class="st">"sheets-append-demo"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; File trashed:</span>
<span class="co">#&gt; • sheets-append-demo &lt;id: 17POdlo-4LqE0Ztx6uSnMq4BR4iXCqAT8x6pP8J_n0mQ&gt;</span></code></pre></div>
</div>
</div>
<div id="range_write" class="section level2">
<h2 class="hasAnchor">
<a href="#range_write" class="anchor"></a><code>range_write()</code>
</h2>
<p><code><a href="../../reference/range_write.html">range_write()</a></code> is the least opinionated writing function. It writes data into a range. It does no explicit formatting, although it can effectively apply formatting by <em>clearing</em> existing formats via <code>reformat = TRUE</code> (the default).</p>
<p>We focus here on the geometry of <code><a href="../../reference/range_write.html">range_write()</a></code>, i.e. which cells are edited.</p>
<p>In a hidden chunk, we’ve created a demo Sheet <code>ss_edit</code> and we’ve filled the cells with “-”. We’ve also created <code>read_this()</code>, a wrapper around <code><a href="../../reference/range_read.html">range_read()</a></code> that names columns by letter, like spreadsheets do.</p>
<p>Here’s the initial state of <code>ss_edit</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">read_this</span><span class="op">(</span><span class="va">ss_edit</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 7 x 7</span>
<span class="co">#&gt;   A     B     C     D     E     F     G    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 2 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 3 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 4 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 5 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 6 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 7 -     -     -     -     -     -     -</span></code></pre></div>
<p><code>df</code> is a small data frame we’ll send as the <code>data</code> argument of <code><a href="../../reference/range_write.html">range_write()</a></code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>V1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">LETTERS</span>,<span class="fl">3</span><span class="op">)</span>, V2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">LETTERS</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   V1    V2   </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 A     X    </span>
<span class="co">#&gt; 2 B     Y    </span>
<span class="co">#&gt; 3 C     Z</span></code></pre></div>
<p>If we do not specify the range, <code>df</code> is written into the upper left corner and only affects cells spanned by <code>df</code>. To see where we’ve written, focus on the cells are NOT “x”.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_write.html">range_write</a></span><span class="op">(</span><span class="va">ss_edit</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">read_this</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Writing to sheet Sheet1</span>
<span class="co">#&gt; ✔ Reading from 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 7 x 7</span>
<span class="co">#&gt;   A     B     C     D     E     F     G    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 V1    V2    -     -     -     -     -    </span>
<span class="co">#&gt; 2 A     X     -     -     -     -     -    </span>
<span class="co">#&gt; 3 B     Y     -     -     -     -     -    </span>
<span class="co">#&gt; 4 C     Z     -     -     -     -     -    </span>
<span class="co">#&gt; 5 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 6 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 7 -     -     -     -     -     -     -</span></code></pre></div>
<p>(Here, and between all subsequent chunks, we reset <code>ss_edit</code> to its initial state.)</p>
<p>If we target a <strong>single cell</strong> with <code>range</code>, it specifies the upper left corner of the target area. The cells written are determined by the extent of the data.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_write.html">range_write</a></span><span class="op">(</span><span class="va">ss_edit</span>, data <span class="op">=</span> <span class="va">df</span>, range <span class="op">=</span> <span class="st">"C2"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">read_this</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Writing to sheet Sheet1</span>
<span class="co">#&gt; ✔ Reading from 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 7 x 7</span>
<span class="co">#&gt;   A     B     C     D     E     F     G    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 2 -     -     V1    V2    -     -     -    </span>
<span class="co">#&gt; 3 -     -     A     X     -     -     -    </span>
<span class="co">#&gt; 4 -     -     B     Y     -     -     -    </span>
<span class="co">#&gt; 5 -     -     C     Z     -     -     -    </span>
<span class="co">#&gt; 6 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 7 -     -     -     -     -     -     -</span></code></pre></div>
<p>If <code>range</code> specifies multiple cells (it can even be unbounded on some sides), it is taken literally and all covered cells are written. If <code>range</code> is larger than the data, this results in some cells being <em>cleared</em> of their values. In this example, the <code>range</code> is “too big” for the data, so the remaining cells are cleared of their existing “-” value.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_write.html">range_write</a></span><span class="op">(</span><span class="va">ss_edit</span>, data <span class="op">=</span> <span class="va">df</span>, range <span class="op">=</span> <span class="st">"D4:G7"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">read_this</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Writing to sheet Sheet1</span>
<span class="co">#&gt; ✔ Reading from 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 7 x 7</span>
<span class="co">#&gt;   A     B     C     D     E     F     G    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 2 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 3 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 4 -     -     -     V1    V2    &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; 5 -     -     -     A     X     &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; 6 -     -     -     B     Y     &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; 7 -     -     -     C     Z     &lt;NA&gt;  &lt;NA&gt;</span></code></pre></div>
<p>Here’s another case where the <code>range</code> is bigger than it needs to be and it’s unbounded on the bottom and top:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_write.html">range_write</a></span><span class="op">(</span><span class="va">ss_edit</span>, data <span class="op">=</span> <span class="va">df</span>, range <span class="op">=</span> <span class="st">"B:E"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">read_this</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Writing to sheet Sheet1</span>
<span class="co">#&gt; ✔ Reading from 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 7 x 7</span>
<span class="co">#&gt;   A     B     C     D     E     F     G    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 -     V1    V2    NA    NA    -     -    </span>
<span class="co">#&gt; 2 -     A     X     NA    NA    -     -    </span>
<span class="co">#&gt; 3 -     B     Y     NA    NA    -     -    </span>
<span class="co">#&gt; 4 -     C     Z     NA    NA    -     -    </span>
<span class="co">#&gt; 5 -     &lt;NA&gt;  &lt;NA&gt;  NA    NA    -     -    </span>
<span class="co">#&gt; 6 -     &lt;NA&gt;  &lt;NA&gt;  NA    NA    -     -    </span>
<span class="co">#&gt; 7 -     &lt;NA&gt;  &lt;NA&gt;  NA    NA    -     -</span></code></pre></div>
<p>Here’s another <code>range</code> that’s unbounded on the left and “too big”:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_write.html">range_write</a></span><span class="op">(</span><span class="va">ss_edit</span>, data <span class="op">=</span> <span class="va">df</span>, range <span class="op">=</span> <span class="st">"B2:6"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">read_this</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Writing to sheet Sheet1</span>
<span class="co">#&gt; ✔ Reading from 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 7 x 7</span>
<span class="co">#&gt;   A     B     C     D     E     F     G    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 -     -     -     -     -     -     -    </span>
<span class="co">#&gt; 2 -     V1    V2    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; 3 -     A     X     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; 4 -     B     Y     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; 5 -     C     Z     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; 6 -     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span>
<span class="co">#&gt; 7 -     -     -     -     -     -     -</span></code></pre></div>
<p>The target sheet will be expanded, if necessary, if and only if <code>range</code> is a single cell (i.e. it gives the upper left corner).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_write.html">range_write</a></span><span class="op">(</span><span class="va">ss_edit</span>, data <span class="op">=</span> <span class="va">df</span>, range <span class="op">=</span> <span class="st">"G6"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">read_this</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Writing to sheet Sheet1</span>
<span class="co">#&gt; ✔ Changing dims: (7 x 7) --&gt; (9 x 8)</span>
<span class="co">#&gt; ✔ Reading from 'sheets-edit-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 9 x 8</span>
<span class="co">#&gt;   A     B     C     D     E     F     G     H    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 -     -     -     -     -     -     -     &lt;NA&gt; </span>
<span class="co">#&gt; 2 -     -     -     -     -     -     -     &lt;NA&gt; </span>
<span class="co">#&gt; 3 -     -     -     -     -     -     -     &lt;NA&gt; </span>
<span class="co">#&gt; 4 -     -     -     -     -     -     -     &lt;NA&gt; </span>
<span class="co">#&gt; 5 -     -     -     -     -     -     -     &lt;NA&gt; </span>
<span class="co">#&gt; 6 -     -     -     -     -     -     V1    V2   </span>
<span class="co">#&gt; 7 -     -     -     -     -     -     A     X    </span>
<span class="co">#&gt; 8 &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  B     Y    </span>
<span class="co">#&gt; 9 &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  C     Z</span></code></pre></div>
<p>Although the <code>data</code> argument of <code><a href="../../reference/range_write.html">range_write()</a></code> must be a data frame, note that this does not actually limit what you can write:</p>
<ul>
<li>Use <code>col_names = FALSE</code> to suppress sending the column names.</li>
<li>By definition, each variable of a data frame can be of different type.</li>
<li>By using a list-column, each row of a data frame column can be of different type.</li>
</ul>
<p>The examples for <code><a href="../../reference/range_write.html">range_write()</a></code> show writing data of disparate type to a 1-row or a 1-column region.</p>
<div id="clean-up-3" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-3" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/gs4_find.html">gs4_find</a></span><span class="op">(</span><span class="st">"sheets-edit-demo"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; File trashed:</span>
<span class="co">#&gt; • sheets-edit-demo &lt;id: 1T_gVCSf8CO27KqsyYaGSCAP_5pdKMMr85xbG2q99wsA&gt;</span></code></pre></div>
</div>
</div>
<div id="write-formulas" class="section level2">
<h2 class="hasAnchor">
<a href="#write-formulas" class="anchor"></a>Write formulas</h2>
<p>All the writing functions can write <em>formulas</em> into cells, if you indicate this in the R object you are writing, i.e. in the data frame. The <code><a href="../../reference/gs4_formula.html">gs4_formula()</a></code> function marks a character vector as containing Sheets formulas, as opposed to regular character strings.</p>
<p>Here’s a demo that also shows off using the Google Translate API inside a Sheet.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lang_dat</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
       <span class="op">~</span> <span class="va">english</span>, <span class="op">~</span> <span class="va">to</span>,
           <span class="st">"dog"</span>, <span class="st">"es"</span>,
   <span class="st">"hello world"</span>, <span class="st">"ko"</span>,
  <span class="st">"baby turtles"</span>, <span class="st">"th"</span> 
<span class="op">)</span>
<span class="va">lang_dat</span><span class="op">$</span><span class="va">translated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_formula.html">gs4_formula</a></span><span class="op">(</span>
  <span class="st">'=GoogleTranslate(INDIRECT("R[0]C[-2]", FALSE), "en", INDIRECT("R[0]C[-1]", FALSE))'</span>
<span class="op">)</span>

<span class="op">(</span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span><span class="st">"sheets-formula-demo"</span>, sheets <span class="op">=</span> <span class="va">lang_dat</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'sheets-formula-demo'</span>
<span class="co">#&gt; Spreadsheet name: sheets-formula-demo</span>
<span class="co">#&gt;               ID: 1tm-xTj7DFuF9StDZXBP4qJjYGvh7DSMIiS56zs9HaGo</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;     lang_dat: 4 x 3</span></code></pre></div>
<p>Now we can read the data back out, complete with translations!</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'sheets-formula-demo'</span>
<span class="co">#&gt; ✔ Range lang_dat</span>
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;   english      to    translated     </span>
<span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;          </span>
<span class="co">#&gt; 1 dog          es    perro          </span>
<span class="co">#&gt; 2 hello world  ko    안녕하세요 세계</span>
<span class="co">#&gt; 3 baby turtles th    ลูกเต่า</span></code></pre></div>
<div id="clean-up-4" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-4" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/gs4_find.html">gs4_find</a></span><span class="op">(</span><span class="st">"sheets-formula-demo"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; File trashed:</span>
<span class="co">#&gt; • sheets-formula-demo &lt;id: 1tm-xTj7DFuF9StDZXBP4qJjYGvh7DSMIiS56zs9HaGo&gt;</span></code></pre></div>
</div>
</div>
<div id="range_flood" class="section level2">
<h2 class="hasAnchor">
<a href="#range_flood" class="anchor"></a><code>range_flood()</code>
</h2>
<p><code><a href="../../reference/range_flood.html">range_flood()</a></code> “floods” all cells in a range with common content. By default, it floods them with no content, i.e. it clears cells of their existing value and format. Note that <code><a href="../../reference/range_flood.html">range_clear()</a></code> is a convenience wrapper for this special case.</p>
<p>First, we create a data frame and initialize a new Sheet with that data.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_fodder.html">gs4_fodder</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="op">(</span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span><span class="st">"range-flood-demo"</span>, sheets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'range-flood-demo'</span>
<span class="co">#&gt; Spreadsheet name: range-flood-demo</span>
<span class="co">#&gt;               ID: 1YP6Qo8NufyyQRcN0QJgjNbSTMtWJl-XkkNNfUa1qhIE</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;       Sheet1: 11 x 10</span></code></pre></div>
<p>To begin, each cell holds its A1-coordinates as its value. If you viewed this in the browser, you’d see the header row has some special formatting, including a gray background.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'range-flood-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 10 x 10</span>
<span class="co">#&gt;    A     B     C     D     E     F     G     H     I     J    </span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt;  1 A2    B2    C2    D2    E2    F2    G2    H2    I2    J2   </span>
<span class="co">#&gt;  2 A3    B3    C3    D3    E3    F3    G3    H3    I3    J3   </span>
<span class="co">#&gt;  3 A4    B4    C4    D4    E4    F4    G4    H4    I4    J4   </span>
<span class="co">#&gt;  4 A5    B5    C5    D5    E5    F5    G5    H5    I5    J5   </span>
<span class="co">#&gt;  5 A6    B6    C6    D6    E6    F6    G6    H6    I6    J6   </span>
<span class="co">#&gt;  6 A7    B7    C7    D7    E7    F7    G7    H7    I7    J7   </span>
<span class="co">#&gt;  7 A8    B8    C8    D8    E8    F8    G8    H8    I8    J8   </span>
<span class="co">#&gt;  8 A9    B9    C9    D9    E9    F9    G9    H9    I9    J9   </span>
<span class="co">#&gt;  9 A10   B10   C10   D10   E10   F10   G10   H10   I10   J10  </span>
<span class="co">#&gt; 10 A11   B11   C11   D11   E11   F11   G11   H11   I11   J11</span></code></pre></div>
<p>By default, <code><a href="../../reference/range_flood.html">range_flood()</a></code> sends an empty cell (and clears existing formatting).</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_flood.html">range_flood</a></span><span class="op">(</span><span class="va">ss</span>, range <span class="op">=</span> <span class="st">"A1:B3"</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'range-flood-demo'</span>
<span class="co">#&gt; ✔ Editing sheet Sheet1</span>
<span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'range-flood-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; New names:</span>
<span class="co">#&gt; * `` -&gt; ...1</span>
<span class="co">#&gt; * `` -&gt; ...2</span>
<span class="co">#&gt; # A tibble: 10 x 10</span>
<span class="co">#&gt;    ...1  ...2  C     D     E     F     G     H     I     J    </span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt;  1 &lt;NA&gt;  &lt;NA&gt;  C2    D2    E2    F2    G2    H2    I2    J2   </span>
<span class="co">#&gt;  2 &lt;NA&gt;  &lt;NA&gt;  C3    D3    E3    F3    G3    H3    I3    J3   </span>
<span class="co">#&gt;  3 A4    B4    C4    D4    E4    F4    G4    H4    I4    J4   </span>
<span class="co">#&gt;  4 A5    B5    C5    D5    E5    F5    G5    H5    I5    J5   </span>
<span class="co">#&gt;  5 A6    B6    C6    D6    E6    F6    G6    H6    I6    J6   </span>
<span class="co">#&gt;  6 A7    B7    C7    D7    E7    F7    G7    H7    I7    J7   </span>
<span class="co">#&gt;  7 A8    B8    C8    D8    E8    F8    G8    H8    I8    J8   </span>
<span class="co">#&gt;  8 A9    B9    C9    D9    E9    F9    G9    H9    I9    J9   </span>
<span class="co">#&gt;  9 A10   B10   C10   D10   E10   F10   G10   H10   I10   J10  </span>
<span class="co">#&gt; 10 A11   B11   C11   D11   E11   F11   G11   H11   I11   J11</span></code></pre></div>
<p>We can’t easily demonstrate this here, but if you are working with a sheet in the browser, you can experiment with <code>reformat = TRUE/FALSE</code> to clear the existing format (or not).</p>
<p>We can also send a new value into a range of cells.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_flood.html">range_flood</a></span><span class="op">(</span><span class="va">ss</span>, range <span class="op">=</span> <span class="st">"4:5"</span>, cell <span class="op">=</span> <span class="st">";-)"</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'range-flood-demo'</span>
<span class="co">#&gt; ✔ Editing sheet Sheet1</span>
<span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'range-flood-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; New names:</span>
<span class="co">#&gt; * `` -&gt; ...1</span>
<span class="co">#&gt; * `` -&gt; ...2</span>
<span class="co">#&gt; # A tibble: 10 x 10</span>
<span class="co">#&gt;    ...1  ...2  C     D     E     F     G     H     I     J    </span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt;  1 &lt;NA&gt;  &lt;NA&gt;  C2    D2    E2    F2    G2    H2    I2    J2   </span>
<span class="co">#&gt;  2 &lt;NA&gt;  &lt;NA&gt;  C3    D3    E3    F3    G3    H3    I3    J3   </span>
<span class="co">#&gt;  3 ;-)   ;-)   ;-)   ;-)   ;-)   ;-)   ;-)   ;-)   ;-)   ;-)  </span>
<span class="co">#&gt;  4 ;-)   ;-)   ;-)   ;-)   ;-)   ;-)   ;-)   ;-)   ;-)   ;-)  </span>
<span class="co">#&gt;  5 A6    B6    C6    D6    E6    F6    G6    H6    I6    J6   </span>
<span class="co">#&gt;  6 A7    B7    C7    D7    E7    F7    G7    H7    I7    J7   </span>
<span class="co">#&gt;  7 A8    B8    C8    D8    E8    F8    G8    H8    I8    J8   </span>
<span class="co">#&gt;  8 A9    B9    C9    D9    E9    F9    G9    H9    I9    J9   </span>
<span class="co">#&gt;  9 A10   B10   C10   D10   E10   F10   G10   H10   I10   J10  </span>
<span class="co">#&gt; 10 A11   B11   C11   D11   E11   F11   G11   H11   I11   J11</span></code></pre></div>
<div id="clean-up-5" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-5" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/gs4_find.html">gs4_find</a></span><span class="op">(</span><span class="st">"range-flood-demo"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; File trashed:</span>
<span class="co">#&gt; • range-flood-demo &lt;id: 1YP6Qo8NufyyQRcN0QJgjNbSTMtWJl-XkkNNfUa1qhIE&gt;</span></code></pre></div>
</div>
</div>
<div id="range_delete" class="section level2">
<h2 class="hasAnchor">
<a href="#range_delete" class="anchor"></a><code>range_delete()</code>
</h2>
<p><code><a href="../../reference/range_delete.html">range_delete()</a></code> deletes a range of cells and shifts other cells into the deleted area. If you’re trying to delete an entire (work)sheet or change its actual dimensions or extent, you should, instead, use <code><a href="../../reference/sheet_delete.html">sheet_delete()</a></code> or <code><a href="../../reference/sheet_resize.html">sheet_resize()</a></code>. If you just want to clear values or formats, use <code><a href="../../reference/range_flood.html">range_clear()</a></code>.</p>
<p>First, we create a data frame and initialize a new Sheet with that data.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_fodder.html">gs4_fodder</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>
<span class="op">(</span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/gs4_create.html">gs4_create</a></span><span class="op">(</span><span class="st">"sheets-delete-demo"</span>, sheets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'sheets-delete-demo'</span>
<span class="co">#&gt; Spreadsheet name: sheets-delete-demo</span>
<span class="co">#&gt;               ID: 1Ak_xPzooCVq50YEYpQNW4QSXUEn4hq-Wup2B2cXL-jU</span>
<span class="co">#&gt;           Locale: en_US</span>
<span class="co">#&gt;        Time zone: Etc/GMT</span>
<span class="co">#&gt;      # of sheets: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class="co">#&gt;       Sheet1: 5 x 4</span></code></pre></div>
<p>To begin, each cell holds its A1-coordinates as its value. If you viewed this in the browser, you’d see the header row has some special formatting, including a gray background.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'sheets-delete-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 4 x 4</span>
<span class="co">#&gt;   A     B     C     D    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 A2    B2    C2    D2   </span>
<span class="co">#&gt; 2 A3    B3    C3    D3   </span>
<span class="co">#&gt; 3 A4    B4    C4    D4   </span>
<span class="co">#&gt; 4 A5    B5    C5    D5</span></code></pre></div>
<p>Let’s delete some rows.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_delete.html">range_delete</a></span><span class="op">(</span><span class="va">ss</span>, range <span class="op">=</span> <span class="st">"2:3"</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'sheets-delete-demo'</span>
<span class="co">#&gt; ✔ Deleting cells in sheet Sheet1</span>
<span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'sheets-delete-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   A     B     C     D    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 A4    B4    C4    D4   </span>
<span class="co">#&gt; 2 A5    B5    C5    D5</span></code></pre></div>
<p>Let’s delete a column.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_delete.html">range_delete</a></span><span class="op">(</span><span class="va">ss</span>, range <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'sheets-delete-demo'</span>
<span class="co">#&gt; ✔ Deleting cells in sheet Sheet1</span>
<span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span>
<span class="co">#&gt; ✔ Reading from 'sheets-delete-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   A     B     D    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 A4    B4    D4   </span>
<span class="co">#&gt; 2 A5    B5    D5</span></code></pre></div>
<p>Let’s delete a bounded cell range. Since it’s unclear how to fill this space, we must specify <code>shift</code>. We’ll fill the space by shifting remaining cells to the left. Remember that <code>range</code> continues to refer to actual rows and columns and, due to our deletions, no longer match with the values which reflect the original locations.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_delete.html">range_delete</a></span><span class="op">(</span><span class="va">ss</span>, range <span class="op">=</span> <span class="st">"B2:B3"</span>, shift <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span>
<span class="co">#&gt; ✔ Editing 'sheets-delete-demo'</span>
<span class="co">#&gt; ✔ Deleting cells in sheet Sheet1</span>
<span class="fu"><a href="../../reference/range_read.html">range_read</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span>
<span class="co">#&gt; → Request failed [429]. Retry 1 happens in 100.5 seconds ...</span>
<span class="co">#&gt; → Request failed [429]. Retry 2 happens in 10.9 seconds ...</span>
<span class="co">#&gt; ✔ Reading from 'sheets-delete-demo'</span>
<span class="co">#&gt; ✔ Range Sheet1</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   A     B     D    </span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt;</span>
<span class="co">#&gt; 1 A4    D4    NA   </span>
<span class="co">#&gt; 2 A5    D5    NA</span></code></pre></div>
<div id="clean-up-6" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-up-6" class="anchor"></a>Clean up</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/gs4_find.html">gs4_find</a></span><span class="op">(</span><span class="st">"sheets-delete-demo"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html">drive_trash</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; File trashed:</span>
<span class="co">#&gt; • sheets-delete-demo &lt;id: 1Ak_xPzooCVq50YEYpQNW4QSXUEn4hq-Wup2B2cXL-jU&gt;</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p>googlesheets4 is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by <a href="https://jennybryan.org">Jennifer Bryan</a>, <a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
