<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="googlesheets4">
<title>Range specification • googlesheets4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.4/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.4/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Range specification">
<meta property="og:description" content="googlesheets4">
<meta property="og:image" content="https://googlesheets4.tidyverse.org/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="googlesheets4.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">googlesheets4</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/googlesheets4.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/read-sheets.html">Read Sheets</a>
    <a class="dropdown-item" href="../articles/write-sheets.html">Write Sheets</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Special topics</h6>
    <a class="dropdown-item" href="../articles/auth.html">googlesheets4 auth</a>
    <a class="dropdown-item" href="../articles/dates-and-times.html">Dates and times</a>
    <a class="dropdown-item" href="../articles/find-identify-sheets.html">Find and identify Sheets</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Connections to other packages</h6>
    <a class="dropdown-item" href="../articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>
    <a class="dropdown-item" href="../articles/fun-with-googledrive-and-readxl.html">Fun with googledrive and readxl</a>
    <a class="dropdown-item" href="../articles/googlesheets4-reprex.html">How to create a googlesheets4 reprex</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/07/googlesheets4-1-0-0/">googlesheets4 1.0.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/">googlesheets4 0.2.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidyverse/googlesheets4/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Range specification</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/googlesheets4/blob/HEAD/vignettes/articles/range-specification.Rmd" class="external-link"><code>vignettes/articles/range-specification.Rmd</code></a></small>
      <div class="d-none name"><code>range-specification.Rmd</code></div>
    </div>

    
    
<p>This is article serves mostly as internal documentation of how
various representations of cell ranges relate to each other in
googlesheets4.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://googlesheets4.tidyverse.org">googlesheets4</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gs4_deauth.html">gs4_deauth</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="user-specified-range">User-specified range<a class="anchor" aria-label="anchor" href="#user-specified-range"></a>
</h2>
<p>Several googlesheets4 functions allow the user to specify which cells
to read or write. This range specification comes via the
<code>sheet</code>, <code>range</code>, and (possibly) <code>skip</code>
arguments. Examples of functions with this interface:
<code><a href="../reference/range_read.html">range_read()</a></code>, <code><a href="../reference/range_read_cells.html">range_read_cells()</a></code>, and
<code><a href="../reference/range_write.html">range_write()</a></code>.</p>
<ul>
<li>
<code>range</code> is the primary and most powerful argument and
takes precedence over all others. <code>range</code> can be:
<ul>
<li>an <a href="https://developers.google.com/sheets/api/guides/concepts#a1_notation" class="external-link">A1-style
spreadsheet range</a>, with or without a sheet name, such as “A3:D7” or
“arts!A5:F15”</li>
<li>a (work)sheet name, such as “arts”</li>
<li>a named range, such as “arts_data”</li>
<li>a <code>cell_limits</code> object made with helpers from the
cellranger package</li>
</ul>
</li>
<li>
<code>sheet</code> can be used to specify a (work)sheet by name,
such as “arts”, or by position, such as 3</li>
<li>
<code>skip</code> is an optional argument that appears in
<code><a href="../reference/range_read.html">range_read()</a></code> and <code><a href="../reference/range_read_cells.html">range_read_cells()</a></code>, to be
compatible with functions like <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code>,
<code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_delim()</a></code>, and
<code><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel()</a></code>.</li>
</ul>
<p>(You might think <code>n_max</code> should also be mentioned here,
but for technical reasons, in general, <code>n_max</code> can only be
enforced after we’ve read data. So it’s not part of the range ingest
problem.)</p>
<p>Loose ends and hangnails:</p>
<ul>
<li>The story around (work)sheet visibility is muddy. But I’m letting
that be, because I have yet to have a user interaction that had anything
to do with sheet (in)visibility.</li>
<li>The problem of a completely unspecified range. In a very hand-wavy
sense, “no range” means “all cells” or “all non-empty cells” or “all
non-empty cells in the first (visible?) sheet”. That is obviously very
imprecise, which means that I have to think about how to handle “no
range” for each individual endpoint or function. Sometimes I inject some
info (such as the first visible worksheet), so we don’t retrieve data
that we will just throw away. This is all very special case-y right
now.</li>
<li>
<code>cell_limits</code> objects can hold sheet information and I
have made no arrangements for that.</li>
<li>Should <code><a href="../reference/range_write.html">range_write()</a></code> have a skip argument, just for
internal consistency?</li>
</ul>
</div>
<div class="section level2">
<h2 id="range-spec">Range spec<a class="anchor" aria-label="anchor" href="#range-spec"></a>
</h2>
<p><code>range_spec</code> is an internal S3 class that is typically
used inside any function that accepts the
<code>(sheet, range, skip)</code> trio.</p>
<p>We need some sort of intermediate storage, in order to translate
between the various ways the user can express their range and the
requirements of different Sheets API endpoints (which differ more than
you’d expect!). We generally require metadata about the associated Sheet
in order to form a <code>range_spec</code>, because we potentially need
to lookup the (work)<code>sheet</code> by position or determine whether
a name refers to a named range or a (work)<code>sheet</code>.</p>
<p>The internal generic <code>as_range_spec()</code> dispatches on
primary argument <code>x</code>, which maps to <code>range</code>. Its
job is to transform user-supplied <code>(sheet, range, skip)</code>
into:</p>
<ul>
<li>
<code>sheet_name</code>: (Work)sheet name, can be
<code>NULL</code>.</li>
<li>
<code>named_range</code>: Name of range, can be <code>NULL</code>.
But if not <code>NULL</code>, then this is the complete specification of
the range, i.e. it cannot be combined with any other information.</li>
<li>
<code>cell_range</code> and/or <code>cell_limits</code>: Ways to
specify a rectangle of cells, can be <code>NULL</code>. If user
specifies <code>skip</code>, that is re-expressed as
<code>cell_limits</code>. At intake, at most one of
<code>cell_range</code> and <code>cell_limits</code> is populated. But
internally, we might populate one from the other, as we prepare the
range to meet the requirements of a specific API endpoint.</li>
<li>
<code>shim</code>: indicates whether the user specified a specific
cell rectangle (<code>shim = TRUE</code>) or we filled in some specifics
pragmatically (<code>shim = FALSE</code>), which is necessary to express
some partially open rectangles in A1-notation. This aspect of the
user-supplied data needs to be retained to inform downstream
post-processing.</li>
<li>(<code>sheets_df</code> and <code>nr_df</code> are retained in a
<code>range_spec</code>, if they were provided to
<code>as_range_spec()</code>.)</li>
<li>Loose end: I wonder if <code>range_spec</code> should have a field
for (work)sheet id.</li>
</ul>
<p>Here’s how various user-specified ranges are stored as a
<code>range_spec</code>.</p>
<table class="table">
<colgroup>
<col width="6%">
<col width="12%">
<col width="1%">
<col width="79%">
</colgroup>
<thead><tr class="header">
<th align="left">sheet</th>
<th align="left">range</th>
<th align="right">skip</th>
<th align="left">range_spec</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">NULL</td>
<td align="left">NULL</td>
<td align="right">0</td>
<td align="left">sheet_name: NULL<br>named_range: NULL<br> cell_range:
NULL<br>cell_limits: NULL<br> shim: FALSE<br> sheets_df:
&lt;provided&gt;<br> nr_df: NULL</td>
</tr>
<tr class="even">
<td align="left">Africa</td>
<td align="left">NULL</td>
<td align="right">0</td>
<td align="left">sheet_name: Africa<br>named_range: NULL<br> cell_range:
NULL<br>cell_limits: NULL<br> shim: FALSE<br> sheets_df:
&lt;provided&gt;<br> nr_df: NULL</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">NULL</td>
<td align="right">0</td>
<td align="left">sheet_name: Europe<br>named_range: NULL<br> cell_range:
NULL<br>cell_limits: NULL<br> shim: FALSE<br> sheets_df:
&lt;provided&gt;<br> nr_df: NULL</td>
</tr>
<tr class="even">
<td align="left">NULL</td>
<td align="left">NULL</td>
<td align="right">2</td>
<td align="left">sheet_name: NULL<br>named_range: NULL<br> cell_range:
NULL<br>cell_limits: list(ul = c(3, NA), lr = c(NA, NA), sheet = NA)<br>
shim: FALSE<br> sheets_df: &lt;provided&gt;<br> nr_df: NULL</td>
</tr>
<tr class="odd">
<td align="left">Africa</td>
<td align="left">NULL</td>
<td align="right">3</td>
<td align="left">sheet_name: Africa<br>named_range: NULL<br> cell_range:
NULL<br>cell_limits: list(ul = c(4, NA), lr = c(NA, NA), sheet = NA)<br>
shim: FALSE<br> sheets_df: &lt;provided&gt;<br> nr_df: NULL</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">NULL</td>
<td align="right">4</td>
<td align="left">sheet_name: Europe<br>named_range: NULL<br> cell_range:
NULL<br>cell_limits: list(ul = c(5, NA), lr = c(NA, NA), sheet = NA)<br>
shim: FALSE<br> sheets_df: &lt;provided&gt;<br> nr_df: NULL</td>
</tr>
<tr class="odd">
<td align="left">&lt;ignored&gt;</td>
<td align="left">Asia!A1:B2</td>
<td align="right">0</td>
<td align="left">sheet_name: Asia<br>named_range: NULL<br> cell_range:
A1:B2<br>cell_limits: NULL<br> shim: TRUE<br> sheets_df:
&lt;provided&gt;<br> nr_df: &lt;provided&gt;</td>
</tr>
<tr class="even">
<td align="left">&lt;ignored&gt;</td>
<td align="left">canada</td>
<td align="right">0</td>
<td align="left">sheet_name: NULL<br>named_range: canada<br> cell_range:
NULL<br>cell_limits: NULL<br> shim: FALSE<br> sheets_df:
&lt;provided&gt;<br> nr_df: &lt;provided&gt;</td>
</tr>
<tr class="odd">
<td align="left">&lt;ignored&gt;</td>
<td align="left">Europe</td>
<td align="right">3</td>
<td align="left">sheet_name: Europe<br>named_range: NULL<br> cell_range:
NULL<br>cell_limits: list(ul = c(4, NA), lr = c(NA, NA), sheet = NA)<br>
shim: FALSE<br> sheets_df: &lt;provided&gt;<br> nr_df: NULL</td>
</tr>
<tr class="even">
<td align="left">NULL</td>
<td align="left">A1:B2</td>
<td align="right">0</td>
<td align="left">sheet_name: NULL<br>named_range: NULL<br> cell_range:
A1:B2<br>cell_limits: NULL<br> shim: TRUE<br> sheets_df:
&lt;provided&gt;<br> nr_df: &lt;provided&gt;</td>
</tr>
<tr class="odd">
<td align="left">Oceania</td>
<td align="left">A1:B2</td>
<td align="right">0</td>
<td align="left">sheet_name: Oceania<br>named_range: NULL<br>
cell_range: A1:B2<br>cell_limits: NULL<br> shim: TRUE<br> sheets_df:
&lt;provided&gt;<br> nr_df: &lt;provided&gt;</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">A1:B2</td>
<td align="right">0</td>
<td align="left">sheet_name: Americas<br>named_range: NULL<br>
cell_range: A1:B2<br>cell_limits: NULL<br> shim: TRUE<br> sheets_df:
&lt;provided&gt;<br> nr_df: &lt;provided&gt;</td>
</tr>
<tr class="odd">
<td align="left">NULL</td>
<td align="left">cell_limits(c(2, 3), c(NA, 5))</td>
<td align="right">0</td>
<td align="left">sheet_name: NULL<br>named_range: NULL<br> cell_range:
NULL<br>cell_limits: list(ul = 2:3, lr = c(NA, 5), sheet = NA)<br> shim:
TRUE<br> sheets_df: &lt;provided&gt;<br> nr_df: NULL</td>
</tr>
<tr class="even">
<td align="left">Americas</td>
<td align="left">cell_limits(c(2, 3), c(NA, 5))</td>
<td align="right">0</td>
<td align="left">sheet_name: Americas<br>named_range: NULL<br>
cell_range: NULL<br>cell_limits: list(ul = 2:3, lr = c(NA, 5), sheet =
NA)<br> shim: TRUE<br> sheets_df: &lt;provided&gt;<br> nr_df: NULL</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="cell-rectangles">Cell rectangles<a class="anchor" aria-label="anchor" href="#cell-rectangles"></a>
</h3>
<p>When a <code>range_spec</code> is first formed, it may hold specifics
for a cell rectangle, although it does not have to. This info appears in
one of these fields:</p>
<ul>
<li>
<code>cell_range</code>: an <a href="https://developers.google.com/sheets/api/guides/concepts#a1_notation" class="external-link">A1-style
spreadsheet range</a>, with NO sheet information
<ul>
<li>Examples: “A4”, “D:G”, “3:7”, “B3:H”, “C4:G16”</li>
</ul>
</li>
<li>a <code>cell_limits</code> object, in the cellranger sense
<ul>
<li>Example: <code>cell_limits(ul = c(2, 3), lr = c(NA, 5)))</code>
</li>
</ul>
</li>
</ul>
<p>A <code>cell_limits</code> object is, overall, a much more sane way
to hold this information, because explicit <code>NA</code>s can be used
to convey unboundedness. Some types of unboundedness simply can’t be
conveyed in A1 notation, even though those partially open rectangles are
as legitimate as those that can be recorded in A1 notation.</p>
<p>In any case, between user expectations and API idiosyncrasies, we
have to be able to translate between <code>cell_range</code> and
<code>cell_limits</code>.</p>
<div class="section level4">
<h4 id="a1-range-from-cell_limits">A1 range from <code>cell_limits</code><a class="anchor" aria-label="anchor" href="#a1-range-from-cell_limits"></a>
</h4>
<p>The reading functions <code><a href="../reference/range_read.html">range_read()</a></code> and
<code><a href="../reference/range_read_cells.html">range_read_cells()</a></code> hit the
<code>sheets.spreadsheets.get</code> endpoint. Bizarrely, this endpoint
requires the range to be specified in A1-notation. If the user specifies
the cell rectangle in A1-notation, things are easy and we essentially
just pass that along. But users can describe certain partially open cell
rectangles via <code>cell_limits</code> that can’t be literally
expressed in A1-notation. The table below shows how all possible
combinations of row and cell limits are translated into an A1-style
range, using technical limits on the number of rows and columns in a
Google Sheet.</p>
<table class="table">
<thead><tr class="header">
<th align="right">start_col</th>
<th align="right">start_row</th>
<th align="right">end_col</th>
<th align="right">end_row</th>
<th align="left">naive_range</th>
<th align="left">range</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">B2:D4</td>
<td align="left">B2:D4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="left">B2:D?</td>
<td align="left">B2:D</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="left">B2:?4</td>
<td align="left">B2:4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">B2:??</td>
<td align="left">B2:ZZZ</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">B?:D4</td>
<td align="left">B1:D4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="left">B?:D?</td>
<td align="left">B:D</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="left">B?:?4</td>
<td align="left">B1:4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">B?:??</td>
<td align="left">B:ZZZ</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">?2:D4</td>
<td align="left">A2:D4</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="left">?2:D?</td>
<td align="left">A2:D</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="left">?2:?4</td>
<td align="left">2:4</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">?2:??</td>
<td align="left">2:10000000</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">??:D4</td>
<td align="left">A1:D4</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="left">??:D?</td>
<td align="left">A:D</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="left">??:?4</td>
<td align="left">1:4</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">??:??</td>
<td align="left">&lt;NULL&gt;</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="cell_limits-from-a1-range">
<code>cell_limits</code> from A1 range<a class="anchor" aria-label="anchor" href="#cell_limits-from-a1-range"></a>
</h4>
<p>When editing a sheet, we send an <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#updatecellsrequest" class="external-link"><code>UpdateCellsRequest</code></a>,
which takes the location of the write via a <em>union field</em>. We
must send one of the following:</p>
<ul>
<li>
<p><code>start</code>: An instance of <code>GridCoordinate</code>
which identifies one cell. This is where the write starts and the cells
hit are determined by the structure of the accompanying
<code>RowData</code>. Think of <code>start</code> as specifying the
upper left corner of a target rectangle. Fields:</p>
<ul>
<li>
<code>sheetId</code>: ID of the (work)sheet. The only required
field.</li>
<li>
<code>rowIndex</code>: Zero-based row index. Unspecified means
0.</li>
<li>
<code>columnIndex</code>: Zero-based column index. Unspecified means
0.</li>
</ul>
</li>
<li>
<p><code>range</code>: An instance of <code>GridRange</code> which
identifies a rectangle of cells. Fields:</p>
<ul>
<li>
<code>sheetId</code>: ID of the (work)sheet. The only required
field.</li>
<li>
<code>startRowIndex</code>: Zero-based inclusive start row.
Unspecified means 0.</li>
<li>
<code>endRowIndex</code>: Zero-based exclusive end row. Unspecified
means unbounded.</li>
<li>
<code>startColumnIndex</code>: Zero-based inclusive start column.
Unspecified means
<ol start="0" style="list-style-type: decimal">
<li>
</ol>
</li>
<li>
<code>endColumnIndex</code>: Zero-based exclusive end column.
Unspecified means unbounded.</li>
</ul>
<p>All the start/end row/column indices are optional. If omitted, it
means the rectangle is unbounded on that side. Unbounded on the left or
top is boring, because that just amounts to starting at the first row or
column. But unbounded on the right or bottom is a more interesting
scenario because of this:</p>
<p>If the <code>RowData</code> doesn’t cover the entire
<code>range</code> rectangle, the targetted cells that don’t receive new
data are cleared, according to the accompanying field mask in
<code>fields</code>.</p>
</li>
</ul>
<p><code><a href="../reference/range_write.html">range_write()</a></code> is the only writing function in
googlesheets4 that lets the user target a specific range. This function
is why we need the ability to convert A1-notation to
<code>cell_limits</code> and to decide whether user’s range should be
sent via <code>start</code> or <code>range</code>.
<code><a href="../reference/gs4_create.html">gs4_create()</a></code>, <code><a href="../reference/sheet_write.html">sheet_write()</a></code>, and
<code><a href="../reference/sheet_append.html">sheet_append()</a></code> all offer a higher-level API, focused on the
holistic management of (work)sheets that hold a single data table.</p>
<p>Here’s a table that translates the A1-style ranges created above into
<code>cell_limits</code>. Some scenarios are covered more than once in
this input, because above we were tackling a different (harder) problem.
But that’s harmless and these inputs are good, in terms of covering all
relevant scenarios. Note I dropped the row corresponding to “no
input”.</p>
<table class="table">
<thead><tr class="header">
<th align="left">range</th>
<th align="left">cell_limits</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">B2:D4</td>
<td align="left">&lt;cell_limits (2, 2) x (4, 4)&gt;</td>
</tr>
<tr class="even">
<td align="left">B2:D</td>
<td align="left">&lt;cell_limits (2, 2) x (-, 4)&gt;</td>
</tr>
<tr class="odd">
<td align="left">B2:4</td>
<td align="left">&lt;cell_limits (2, 2) x (4, -)&gt;</td>
</tr>
<tr class="even">
<td align="left">B2:ZZZ</td>
<td align="left">&lt;cell_limits (2, 2) x (-, 18278)&gt;</td>
</tr>
<tr class="odd">
<td align="left">B1:D4</td>
<td align="left">&lt;cell_limits (1, 2) x (4, 4)&gt;</td>
</tr>
<tr class="even">
<td align="left">B:D</td>
<td align="left">&lt;cell_limits (-, 2) x (-, 4)&gt;</td>
</tr>
<tr class="odd">
<td align="left">B1:4</td>
<td align="left">&lt;cell_limits (1, 2) x (4, -)&gt;</td>
</tr>
<tr class="even">
<td align="left">B:ZZZ</td>
<td align="left">&lt;cell_limits (-, 2) x (-, 18278)&gt;</td>
</tr>
<tr class="odd">
<td align="left">A2:D4</td>
<td align="left">&lt;cell_limits (2, 1) x (4, 4)&gt;</td>
</tr>
<tr class="even">
<td align="left">A2:D</td>
<td align="left">&lt;cell_limits (2, 1) x (-, 4)&gt;</td>
</tr>
<tr class="odd">
<td align="left">2:4</td>
<td align="left">&lt;cell_limits (2, -) x (4, -)&gt;</td>
</tr>
<tr class="even">
<td align="left">2:10000000</td>
<td align="left">&lt;cell_limits (2, -) x (10000000, -)&gt;</td>
</tr>
<tr class="odd">
<td align="left">A1:D4</td>
<td align="left">&lt;cell_limits (1, 1) x (4, 4)&gt;</td>
</tr>
<tr class="even">
<td align="left">A:D</td>
<td align="left">&lt;cell_limits (-, 1) x (-, 4)&gt;</td>
</tr>
<tr class="odd">
<td align="left">1:4</td>
<td align="left">&lt;cell_limits (1, -) x (4, -)&gt;</td>
</tr>
</tbody>
</table>
<p>How to decide whether to send user’s range via <code>start</code> or
<code>range</code>? Possible scenarios for <code>(sheet, range)</code>
(remember: so far, <code><a href="../reference/range_write.html">range_write()</a></code> doesn’t offer
<code>skip</code>):</p>
<ul>
<li>
<code>sheet</code> not given: populate with first (visible)
sheet.</li>
<li>No <code>range</code>: Send sheet ID as <code>GridCoordinate</code>
via <code>start</code>. We will overwrite data (and usually formats) in
cells covered by the accompanying <code>data</code>. But we don’t touch
the rest of the sheet. Why not send as <code>range</code>? That feels
too aggressive because it clears the data (and usually formats) of any
cells in the sheet that are not covered by the <code>data</code>. But if
user wants that, there’s always <code><a href="../reference/range_write.html">range_write()</a></code>.</li>
<li>
<code>range</code> as A1 notation: Re-express it as
<code>cell_limits</code>.</li>
<li>
<code>range</code> as <code>cell_limits</code> breaks down into a
couple scenarios:
<ul>
<li>
<code>cell_limits</code> contains at least 1 <code>NA</code>: send
as <code>GridRange</code> via <code>range</code>. Analysis of the “all
<code>NA</code>” edge case: we send just the sheet ID as a
<code>GridRange</code>, so we will clear the targeted fields for the
whole sheet. This seems OK here, because no one can do this by accident,
i.e. you have to go out of your way to make an explicit
<code>cell_limits</code> object containing only <code>NA</code>s. Why
would you do this instead of <code><a href="../reference/range_write.html">range_write()</a></code>? Maybe you need
to suppress the inclusion of <code>col_names</code> or you don’t like
the table formatting applied by <code><a href="../reference/range_write.html">range_write()</a></code>.</li>
<li>
<code>cell_limits</code> has no <code>NA</code>s: If rectangle
includes more than 1 cell, send as <code>GridRange</code> via
<code>range</code>. If rectangle is exactly 1 cell, send as
<code>GridCoordinate</code> via <code>start</code>.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, <a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" width="72"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

  </div></footer>
</body>
</html>
