<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="googlesheets4">
<title>Find and identify Sheets • googlesheets4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.2/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find and identify Sheets">
<meta property="og:description" content="googlesheets4">
<meta property="og:image" content="https://googlesheets4.tidyverse.org/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="googlesheets4.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">googlesheets4</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/googlesheets4.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/read-sheets.html">Read Sheets</a>
    <a class="dropdown-item" href="../articles/write-sheets.html">Write Sheets</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Special topics</h6>
    <a class="dropdown-item" href="../articles/auth.html">googlesheets4 auth</a>
    <a class="dropdown-item" href="../articles/dates-and-times.html">Dates and times</a>
    <a class="dropdown-item" href="../articles/find-identify-sheets.html">Find and identify Sheets</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Connections to other packages</h6>
    <a class="dropdown-item" href="../articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>
    <a class="dropdown-item" href="../articles/fun-with-googledrive-and-readxl.html">Fun with googledrive and readxl</a>
    <a class="dropdown-item" href="../articles/googlesheets4-reprex.html">How to create a googlesheets4 reprex</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/07/googlesheets4-1-0-0/">googlesheets4 1.0.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/">googlesheets4 0.2.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidyverse/googlesheets4/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Find and identify Sheets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/googlesheets4/blob/HEAD/vignettes/articles/find-identify-sheets.Rmd" class="external-link"><code>vignettes/articles/find-identify-sheets.Rmd</code></a></small>
      <div class="d-none name"><code>find-identify-sheets.Rmd</code></div>
    </div>

    
    
<p>There are many ways to get your hands on your Sheets, in order to
work with them via googlesheets4. They basically range from “ugly, but
low effort” to “more humane, but more effort”.</p>
<div class="section level2">
<h2 id="attach-googlesheets4">Attach googlesheets4<a class="anchor" aria-label="anchor" href="#attach-googlesheets4"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://googlesheets4.tidyverse.org">googlesheets4</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="auth">Auth<a class="anchor" aria-label="anchor" href="#auth"></a>
</h2>
<p>As a regular, interactive user, you can just let googlesheets4 prompt
you for anything it needs re: auth.</p>
<p>Since this article is compiled noninteractively on a server, we have
arranged for googlesheets4 to use a service account token (not
shown).</p>
</div>
<div class="section level2">
<h2 id="use-a-url">Use a URL<a class="anchor" aria-label="anchor" href="#use-a-url"></a>
</h2>
<p>When you visit a Sheet in the browser, you can copy that URL to your
clipboard. Such URLs look something like this:</p>
<pre><code>https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077</code></pre>
<p>which breaks down like this:</p>
<pre><code>https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit#gid=SHEET_ID</code></pre>
<p>Notice that this URL contains a (spread)Sheet ID and a (work)sheet
ID. This URL happens to link to <a href="https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077" class="external-link">the
official example Sheet that holds Gapminder data</a>.</p>
<p>googlesheets4 accepts such a URL as the <code>ss</code> argument
(think “spreadsheet”) of many functions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ugly_url</span> <span class="op">&lt;-</span> <span class="st">"https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077"</span></span>
<span><span class="fu"><a href="../reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">ugly_url</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">gapminder</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range <span style="color: #BBBB00;">Africa</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 624 × 6</span></span></span>
<span><span class="co">#&gt;   country continent  year lifeExp      pop gdpPercap</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Algeria Africa     <span style="text-decoration: underline;">1</span>952    43.1  9<span style="text-decoration: underline;">279</span>525     <span style="text-decoration: underline;">2</span>449.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Algeria Africa     <span style="text-decoration: underline;">1</span>957    45.7 10<span style="text-decoration: underline;">270</span>856     <span style="text-decoration: underline;">3</span>014.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Algeria Africa     <span style="text-decoration: underline;">1</span>962    48.3 11<span style="text-decoration: underline;">000</span>948     <span style="text-decoration: underline;">2</span>551.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Algeria Africa     <span style="text-decoration: underline;">1</span>967    51.4 12<span style="text-decoration: underline;">760</span>499     <span style="text-decoration: underline;">3</span>247.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Algeria Africa     <span style="text-decoration: underline;">1</span>972    54.5 14<span style="text-decoration: underline;">760</span>787     <span style="text-decoration: underline;">4</span>183.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 619 more rows</span></span></span></code></pre></div>
<p>At this time, although the URL may contain both a (spread)Sheet and a
(work)sheet, we only extract the (spread)Sheet ID. If the function
targets a specific (work)sheet, that is typically specified via
arguments like <code>range</code> or <code>sheet</code> or a default of
“first (visible) sheet”.</p>
<p>These URLs are not particularly nice to look at in your code,
though.</p>
</div>
<div class="section level2">
<h2 id="use-a-sheet-id">Use a Sheet ID<a class="anchor" aria-label="anchor" href="#use-a-sheet-id"></a>
</h2>
<p>You can extract the Sheet ID from a URL with
<code><a href="../reference/sheets_id.html">as_sheets_id()</a></code> (which is what we are doing internally to
make the URL work in the first place):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sheets_id.html">as_sheets_id</a></span><span class="op">(</span><span class="va">ugly_url</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sheets_id"  "drive_id"   "vctrs_vctr" "character"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY"</span></span></code></pre></div>
<p><code><a href="../reference/sheets_id.html">as_sheets_id()</a></code> is a generic function, which means it
knows what to do with a few different types of input. For character
string input, <code><a href="../reference/sheets_id.html">as_sheets_id()</a></code> passes a string through,
unless it looks like a URL. If it looks like a URL, we use a regular
expression to extract the Sheet ID. The returned string bears the
classes <code>sheets_id</code> and <code>drive_id</code> (for playing
nicely with googledrive).</p>
<p>Why did we call <code>unclass(ssid)</code> above to see the naked
Sheet ID? Because, by default, when you print an instance of
<code>sheets_id</code>, we attempt to show you some current metadata
about the Sheet.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssid</span></span>
<span><span class="co">#&gt;  Spreadsheet name: gapminder</span></span>
<span><span class="co">#&gt;                ID: 1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY</span></span>
<span><span class="co">#&gt;            Locale: en_US</span></span>
<span><span class="co">#&gt;         Time zone: America/Los_Angeles</span></span>
<span><span class="co">#&gt;       # of sheets: 5</span></span>
<span><span class="co">#&gt; # of named ranges: 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span><span class="co">#&gt;       Africa: 625 x 6</span></span>
<span><span class="co">#&gt;     Americas: 301 x 6</span></span>
<span><span class="co">#&gt;         Asia: 397 x 6</span></span>
<span><span class="co">#&gt;       Europe: 361 x 6</span></span>
<span><span class="co">#&gt;      Oceania: 25 x 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Named range): (A1 range)        </span></span>
<span><span class="co">#&gt;        canada: 'Americas'!A38:F49</span></span></code></pre></div>
<p>This is the same metadata you’ll see when you call
<code><a href="../reference/gs4_get.html">gs4_get()</a></code> (but you must call <code><a href="../reference/gs4_get.html">gs4_get()</a></code>
explicitly if you want to <em>store</em> the returned metadata).</p>
<p>googlesheets4 also accepts a Sheet ID as the <code>ss</code> argument
of many functions:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">gapminder</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range <span style="color: #BBBB00;">Africa</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 624 × 6</span></span></span>
<span><span class="co">#&gt;   country continent  year lifeExp      pop gdpPercap</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Algeria Africa     <span style="text-decoration: underline;">1</span>952    43.1  9<span style="text-decoration: underline;">279</span>525     <span style="text-decoration: underline;">2</span>449.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Algeria Africa     <span style="text-decoration: underline;">1</span>957    45.7 10<span style="text-decoration: underline;">270</span>856     <span style="text-decoration: underline;">3</span>014.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Algeria Africa     <span style="text-decoration: underline;">1</span>962    48.3 11<span style="text-decoration: underline;">000</span>948     <span style="text-decoration: underline;">2</span>551.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Algeria Africa     <span style="text-decoration: underline;">1</span>967    51.4 12<span style="text-decoration: underline;">760</span>499     <span style="text-decoration: underline;">3</span>247.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Algeria Africa     <span style="text-decoration: underline;">1</span>972    54.5 14<span style="text-decoration: underline;">760</span>787     <span style="text-decoration: underline;">4</span>183.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 619 more rows</span></span></span></code></pre></div>
<p>I think in a script or app that will endure for a while it is better
to refer to a Sheet by its ID than by its URL. The Sheet ID is nicer to
look at, it is complete, it is minimal.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssid</span> <span class="op">&lt;-</span> <span class="st">"1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY"</span></span>
<span><span class="fu"><a href="../reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">gapminder</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range <span style="color: #BBBB00;">Africa</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 624 × 6</span></span></span>
<span><span class="co">#&gt;   country continent  year lifeExp      pop gdpPercap</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Algeria Africa     <span style="text-decoration: underline;">1</span>952    43.1  9<span style="text-decoration: underline;">279</span>525     <span style="text-decoration: underline;">2</span>449.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Algeria Africa     <span style="text-decoration: underline;">1</span>957    45.7 10<span style="text-decoration: underline;">270</span>856     <span style="text-decoration: underline;">3</span>014.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Algeria Africa     <span style="text-decoration: underline;">1</span>962    48.3 11<span style="text-decoration: underline;">000</span>948     <span style="text-decoration: underline;">2</span>551.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Algeria Africa     <span style="text-decoration: underline;">1</span>967    51.4 12<span style="text-decoration: underline;">760</span>499     <span style="text-decoration: underline;">3</span>247.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Algeria Africa     <span style="text-decoration: underline;">1</span>972    54.5 14<span style="text-decoration: underline;">760</span>787     <span style="text-decoration: underline;">4</span>183.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 619 more rows</span></span></span></code></pre></div>
<p>Note this demonstration that a Sheet ID also works when provided as a
plain, old string, i.e. it does not <strong>have</strong> to have the
<code>sheets_id</code> class. In some contexts, you might even prefer to
store it as a string, in order to bypass the special printing behaviour
for <code>sheets_id</code>.</p>
<p>When the Sheet is specified via a character string, googlesheets4
assumes it is a Sheet ID (or an ID-containing URL). This is NOT the case
for googledrive, which assumes a character string is a file name or
path. Therefore, for maximum happiness, in a mixed googlesheets4 /
googledrive workflow, it’s a good idea to be explicit and declare a
string to be a Sheet ID, when that is the case.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sheets_id.html">as_sheets_id</a></span><span class="op">(</span><span class="st">"1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Reading from <span style="color: #00BBBB;">gapminder</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Range <span style="color: #BBBB00;">Africa</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 624 × 6</span></span></span>
<span><span class="co">#&gt;   country continent  year lifeExp      pop gdpPercap</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Algeria Africa     <span style="text-decoration: underline;">1</span>952    43.1  9<span style="text-decoration: underline;">279</span>525     <span style="text-decoration: underline;">2</span>449.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Algeria Africa     <span style="text-decoration: underline;">1</span>957    45.7 10<span style="text-decoration: underline;">270</span>856     <span style="text-decoration: underline;">3</span>014.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Algeria Africa     <span style="text-decoration: underline;">1</span>962    48.3 11<span style="text-decoration: underline;">000</span>948     <span style="text-decoration: underline;">2</span>551.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Algeria Africa     <span style="text-decoration: underline;">1</span>967    51.4 12<span style="text-decoration: underline;">760</span>499     <span style="text-decoration: underline;">3</span>247.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Algeria Africa     <span style="text-decoration: underline;">1</span>972    54.5 14<span style="text-decoration: underline;">760</span>787     <span style="text-decoration: underline;">4</span>183.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 619 more rows</span></span></span></code></pre></div>
<p>If your script or app targets a specific Sheet, the most efficient
and robust way to address it is by its ID.</p>
</div>
<div class="section level2">
<h2 id="use-the-sheets-name-uses-googledrive">Use the Sheet’s name (uses googledrive)<a class="anchor" aria-label="anchor" href="#use-the-sheets-name-uses-googledrive"></a>
</h2>
<p>A big feature of the googledrive package is the ability to navigate
between human-friendly file names and machine-friendly file IDs. Both
the Drive and Sheets APIs require the use of IDs, so the illusion that
you can identify a Drive file by name is provided by the googledrive
package. (A Google Sheet is just a special case of a Drive file … a file
that happens to be a spreadsheet.)</p>
<p>If you need to refer to a Sheet by name, i.e. if you need to lookup
its file ID based on its name, you must use the googledrive package for
that. There are other reasons for using these two packages together: the
Sheets API has an intentionally narrow focus on spreadsheet operations
involving worksheets and cells. General whole-file operations, like copy
/ rename / move / share, must be done via the Drive API and, within R,
via googledrive. See the article <a href="https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html">Using
googlesheets4 with googledrive</a> for more.</p>
<p>It’s time to attach googledrive (in addition to the already-attached
googlesheets4):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://googledrive.tidyverse.org" class="external-link">googledrive</a></span><span class="op">)</span></span></code></pre></div>
<p>(In our hidden auth chunk, we actually put a shared token into force
for both googlesheets4 and googledrive, anticipating this moment.)</p>
<p>The Sheet we’ve been working with is named “gapminder” and is owned
by the account we’ve logged in as here. We can use
<code><a href="https://googledrive.tidyverse.org/reference/drive_get.html" class="external-link">googledrive::drive_get()</a></code> to identify a file by name:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">gap_dribble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_get.html" class="external-link">drive_get</a></span><span class="op">(</span><span class="st">"gapminder"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> The input `path` resolved to exactly 1 file.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A dribble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   name      path      id                                      drive_reso…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;drv_id&gt;</span>                                <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> gapminder gapminder 1ksUQqF_K5yKbJr_uWVnFVZhVuxwMyZCvK6MZO… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​drive_resource</span></span></span></code></pre></div>
<p><code><a href="https://googledrive.tidyverse.org/reference/drive_get.html" class="external-link">drive_get()</a></code> returns a <a href="https://googledrive.tidyverse.org/reference/dribble.html" class="external-link"><code>dribble</code></a>,
a “Drive tibble”, where each row holds info on a Drive file.
<code><a href="../reference/sheets_id.html">as_sheets_id()</a></code> also accepts a one-row <code>dribble</code>,
so we can get right into our normal googlesheets4 workflows:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gap_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sheets_id.html">as_sheets_id</a></span><span class="op">(</span><span class="va">gap_dribble</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="va">gap_id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1ksUQqF_K5yKbJr_uWVnFVZhVuxwMyZCvK6MZOEb7Kew"</span></span>
<span><span class="va">gap_id</span></span>
<span><span class="co">#&gt;  Spreadsheet name: gapminder</span></span>
<span><span class="co">#&gt;                ID: 1ksUQqF_K5yKbJr_uWVnFVZhVuxwMyZCvK6MZOEb7Kew</span></span>
<span><span class="co">#&gt;            Locale: en_US</span></span>
<span><span class="co">#&gt;         Time zone: America/Los_Angeles</span></span>
<span><span class="co">#&gt;       # of sheets: 5</span></span>
<span><span class="co">#&gt; # of named ranges: 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Sheet name): (Nominal extent in rows x columns)</span></span>
<span><span class="co">#&gt;       Africa: 625 x 6</span></span>
<span><span class="co">#&gt;     Americas: 301 x 6</span></span>
<span><span class="co">#&gt;         Asia: 397 x 6</span></span>
<span><span class="co">#&gt;       Europe: 361 x 6</span></span>
<span><span class="co">#&gt;      Oceania: 25 x 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Named range): (A1 range)        </span></span>
<span><span class="co">#&gt;        canada: 'Americas'!A38:F49</span></span></code></pre></div>
<p>Since we generally call <code><a href="../reference/sheets_id.html">as_sheets_id()</a></code> on whatever the
user provides as <code>ss</code>, you can even pass
<code>gap_dribble</code> straight into googlesheets4 functions.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sheet_properties.html">sheet_properties</a></span><span class="op">(</span><span class="va">gap_dribble</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 8</span></span></span>
<span><span class="co">#&gt;   name     index         id type  visible grid_rows grid_columns data  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Africa       0  780<span style="text-decoration: underline;">868</span>077 GRID  TRUE          625            6 <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Americas     1   45<span style="text-decoration: underline;">759</span>261 GRID  TRUE          301            6 <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Asia         2 <span style="text-decoration: underline;">1</span>984<span style="text-decoration: underline;">823</span>455 GRID  TRUE          397            6 <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Europe       3 <span style="text-decoration: underline;">1</span>503<span style="text-decoration: underline;">562</span>052 GRID  TRUE          361            6 <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Oceania      4 <span style="text-decoration: underline;">1</span>796<span style="text-decoration: underline;">776</span>040 GRID  TRUE           25            6 <span style="color: #949494;">&lt;NULL&gt;</span></span></span></code></pre></div>
<p>Two important things to note:</p>
<ul>
<li>googledrive requires auth for functions like
<code><a href="https://googledrive.tidyverse.org/reference/drive_get.html" class="external-link">drive_get()</a></code> and <code><a href="https://googledrive.tidyverse.org/reference/drive_find.html" class="external-link">drive_find()</a></code> (see below). At
first, you can just react to the interactive auth prompts and
<strong>make sure you auth as the same user</strong> with googledrive
and googlesheets4. Once you get tired of doing auth for both packages,
read the article <a href="https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html">Using
googlesheets4 with googledrive</a>. Coordinated auth should get even
easier in the future.
<ul>
<li>In our hidden auth here, we have taken special measures to use a
shared token for googledrive and googlesheets4.</li>
</ul>
</li>
<li>Remember to use <code><a href="https://googledrive.tidyverse.org/reference/drive_get.html" class="external-link">drive_get()</a></code> on a Sheet name
<strong>that you have</strong>. If you don’t have a Sheet named
“gapminder”, the code above won’t yield anything. As a rough rule of
thumb, if you don’t see it at <a href="http://spreadsheets.google.com" class="external-link">spreadsheets.google.com</a>, you
can’t <code><a href="https://googledrive.tidyverse.org/reference/drive_get.html" class="external-link">drive_get()</a></code> it either.</li>
</ul>
</div>
<div class="section level2">
<h2 id="list-your-sheets-uses-googledrive">List your Sheets (uses googledrive)<a class="anchor" aria-label="anchor" href="#list-your-sheets-uses-googledrive"></a>
</h2>
<p>What if you want to see all of your Sheets? Or all the Sheets with
“gap” in their name?</p>
<p><code><a href="https://googledrive.tidyverse.org/reference/drive_find.html" class="external-link">googledrive::drive_find()</a></code> is the workhorse function for
these tasks for general Drive files. It has lots of bells and whistles
and we can use one of them to narrow the search to Google Sheets:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_find.html" class="external-link">drive_find</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"spreadsheet"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A dribble: 9 × 3</span></span></span>
<span><span class="co">#&gt;   name              id                                        drive_reso…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;drv_id&gt;</span>                                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> geological-canary 13fmUp01xitQrPvgw7LWDXNMHiMewxHnPuYHaig2… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> blubbery-lobo     1foTYXQEknymPpyug1xWOq7ituJ-ywLCaTEHaF2y… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> bacciform-booby   15WqCxHBCjY4P_i6-uTL9rUBgpcHRKQFrqheRSSO… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> childsafe-squid   1uGu_BHwialVz6okcuO5kRgLhaprClnzq5Orgc9B… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> fiery-hart        18KiiL2AGkL9nTkjHdOXGmeUQzqnOLqWnnOIEnWY… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 4 more rows, and abbreviated variable name ¹​drive_resource</span></span></span></code></pre></div>
<p>This is so handy that we’ve made <code><a href="../reference/gs4_find.html">gs4_find()</a></code> in
googlesheets4, which is a shortcut for
<code>drive_find(type = "spreadsheet")</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gs4_find.html">gs4_find</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A dribble: 9 × 3</span></span></span>
<span><span class="co">#&gt;   name              id                                        drive_reso…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;drv_id&gt;</span>                                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> geological-canary 13fmUp01xitQrPvgw7LWDXNMHiMewxHnPuYHaig2… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> blubbery-lobo     1foTYXQEknymPpyug1xWOq7ituJ-ywLCaTEHaF2y… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> bacciform-booby   15WqCxHBCjY4P_i6-uTL9rUBgpcHRKQFrqheRSSO… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> childsafe-squid   1uGu_BHwialVz6okcuO5kRgLhaprClnzq5Orgc9B… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> fiery-hart        18KiiL2AGkL9nTkjHdOXGmeUQzqnOLqWnnOIEnWY… &lt;named list&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 4 more rows, and abbreviated variable name ¹​drive_resource</span></span></span></code></pre></div>
<p>See the examples for <code><a href="https://googledrive.tidyverse.org/reference/drive_find.html" class="external-link">drive_find()</a></code> and
<code><a href="../reference/gs4_find.html">gs4_find()</a></code> for more ideas about how to search Drive
effectively for your Sheets.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, <a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" width="72"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

  </div></footer>
</body>
</html>
